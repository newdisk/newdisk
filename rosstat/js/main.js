function Ctrl(){function e(e,a){a.addClass("disabled");var r=!0,n=0,o=0,i=P.questionList[P.structure.pages[P.bookmark].testId].questions;qUAns=P.questionList[P.structure.pages[P.bookmark].testId].givenAnswer,qUAns[P.currentQuest]={answers:[]},a.each(function(e,t){qUAns[P.currentQuest].answers[e]={},"true"===$(t).attr("right")&&o++,qUAns[P.currentQuest].answers[e].label=$(t).text(),qUAns[P.currentQuest].answers[e].right=$(t).attr("right"),$(t).hasClass("selected")?("true"!==$(t).attr("right")?r=!1:n++,qUAns[P.currentQuest].answers[e].selected=1):qUAns[P.currentQuest].answers[e].selected=0}),r&&n==o?(i[P.currentQuest].score=100,P.testScore+=100):i[P.currentQuest].score=0,i[P.currentQuest].status="answered",$(e).find(".test_questions_panel_question").eq(P.currentQuest).attr("class","test_questions_panel_question answered");for(var c=0,u=0,l="",d=!0,p=0;p<i.length;p++)if("answered"!=i[p].status){d=!1,firstPassed=p;break}d?(P.testScore>0&&(c=Math.floor(P.testScore/i.length)),l='<p class="test_popup_text__result"><span>Ваш результат: '+c+"%</span></p>",Ce[P.structure.pages[P.bookmark].chapterIndex].score=c,c<50?(Ce[P.structure.pages[P.bookmark].chapterIndex].status=0,l+='<p class="test_popup_text__msg1">Вам не удалось ответить на вопросы тестирования в достаточном объеме. Может быть, вы были невнимательны или что-то отвлекло вас.</p><p>Вернитесь к материалам лекции для повторения и попробуйте пройти тестирование еще раз.</p>'):c>=50&&c<80?(Ce[P.structure.pages[P.bookmark].chapterIndex].status=1,l+='<p class="test_popup_text__msg1__red">Вам не удалось ответить на вопросы тестирования в достаточном объеме. Может быть, вы были невнимательны или что-то отвлекло вас.</p><p>Вернитесь к материалам лекции для повторения и попробуйте пройти тестирование еще раз.</p>'):c>=80&&(Ce[P.structure.pages[P.bookmark].chapterIndex].status=2,l+=P.bookmark==P.structure.pages.length-1?"<p>Поздравляем! Вы успешно ответили на вопросы итогового теста.</p>":"<p>Поздравляем! Вы успешно ответили на вопросы тестирования по лекции.</p>"),P.bookmark==P.structure.pages.length-1?headComment="Результаты итогового тестирования":headComment="Результаты тестирования по лекции",$(".test_answBtn").addClass("disabled").attr("disabled",!0),$(".test_passBtn").addClass("disabled").attr("disabled",!0),P.sendResult(u,c,l,0,headComment),s(P.currentQuest)):(P.currentQuest++,t(e,-1))}function t(e,s){var a=P.questionList[P.structure.pages[P.bookmark].testId].questions;if(s>-1)return P.currentQuest=s,void P.makeTask(e,P.currentQuest,!1);if(P.currentQuest>=a.length){for(var r=0;r<a.length;r++)if("answered"!=a[r].status)return P.currentQuest=r,void P.makeTask(e,P.currentQuest,!1)}else"answered"==a[P.currentQuest].status?(P.currentQuest++,t(e,-1)):P.makeTask(e,P.currentQuest,!1)}function s(e){P.makeTask(window.document,e,!0);var t=$(".answer"),a=P.questionList[P.structure.pages[P.bookmark].testId].givenAnswer[e].answers;t.off();for(var r=0;r<a.length;r++)a[r].selected&&t.eq(r).addClass("selected");$(".test_questions_panel_question").off().on("click",function(){var e=Number($(this).attr("order"));s(e)}).removeClass("answered")}function a(){document.getElementById("main-preloader").style.display="none",P.startCourse()}function r(){P.structure=courseStructure,M=testStructure;try{void 0!=localStorage.rosstat_data&&(L=JSON.parse(localStorage.rosstat_data),console.info("load from local",L))}catch(e){}n(),o()}function n(){var e=0,t=0;if(ge=P.structure.disabledBtnMsg,P.strongNavigation=P.structure.strongNavigation,P.successScore=P.structure.successScore,P.volume=P.structure.volumeLvl,void 0!=L)ye=L.suspend_main.chapters,ke=L.suspend_main,P.bookmark_main=L.suspend_main.bookmark,$e=L.suspend_intro.chapters,ve=L.suspend_intro,P.bookmark_intro=L.suspend_intro.bookmark,P.learner=L.suspend_main.learner,P.age=L.suspend_main.age;else{ve=i(courseStructure_intro.pages),fe=ke=i(P.structure.pages),ye.push({title:P.structure.chapters[0],startPage:0,status:-1,score:-1});for(var s=0;s<P.structure.pages.length;s++){if(P.structure.pages[s].chapterIndex==e&&t++,P.structure.pages[s].chapterIndex>e){var a={title:P.structure.chapters[P.structure.pages[s].chapterIndex],startPage:s,status:-1,score:-1};ye[e].pagesTotal=t,t=1,ye.push(a),e++}s==P.structure.pages.length-1&&(0==t&&t++,ye[e].pagesTotal=t),P.structure.pages[s].orderInChapter=t,ke.pages[s].orderInChapter=t}}console.warn("chapters_main",ye),be=P.structure.pages.length,G.slider({range:"min",min:0,max:be,animate:"slow"}).slider("disable"),oe.on("click",function(){$(this).hasClass("disabled")||($(this).hasClass("off")?(P.coursePage.soundCtrl("volume",we),de.attr("vol",xe),$(".audioCtrl_soundBtn25, .audioCtrl_soundBtn50, .audioCtrl_soundBtn75, .audioCtrl_soundBtn100").removeClass("disabled"),$(this).removeClass("off")):(P.coursePage.soundCtrl("volume",0),de.attr("vol","vol_0"),$(".audioCtrl_soundBtn25, .audioCtrl_soundBtn50, .audioCtrl_soundBtn75, .audioCtrl_soundBtn100").addClass("disabled"),$(this).addClass("off")))}),ie.on("click",function(){$(this).hasClass("disabled")||(P.coursePage.soundCtrl("volume",25),we=25,xe="vol_25",de.attr("vol","vol_25"))}),ce.on("click",function(){$(this).hasClass("disabled")||(P.coursePage.soundCtrl("volume",50),we=50,xe="vol_50",de.attr("vol","vol_50"))}),ue.on("click",function(){$(this).hasClass("disabled")||(P.coursePage.soundCtrl("volume",75),we=75,xe="vol_75",de.attr("vol","vol_75"))}),le.on("click",function(){$(this).hasClass("disabled")||(P.coursePage.soundCtrl("volume",100),we=100,xe="vol_100",de.attr("vol","vol_100"))}),$(".audioCtrl_play").on("click",function(){$(this).hasClass("pause")?($(this).removeClass("pause"),P.coursePage.soundCtrl("play")):($(this).addClass("pause"),P.coursePage.soundCtrl("pause"))}),pe.slider({range:"min",min:0,max:100,start:function(e,t){P.coursePage.soundCtrl("pause")},stop:function(e,t){$(".audioCtrl_play").hasClass("pause")||P.coursePage.soundCtrl("play")},slide:function(e,t){P.coursePage.soundCtrl("seek",t.value)},change:function(e,t){}}),Y.animate({opacity:0},0),$("#container").tooltip({items:"[jqtitle]",content:function(){return $(this).attr("jqtitle")}}),$("#course-title").find("p").text(P.structure.courseTitle);var r=$(".mainPage_body_item");r.eq(0).on("click",function(){be=courseStructure_intro.pages.length,P.bookmark=P.bookmark_intro,fe=ve,P.structure=courseStructure_intro,Ce=$e,u(P.structure.pages),$("#container").attr("data-style","intro"),C(P.bookmark),$(".mainPage").css({display:"none"})}),r.eq(1).on("click",function(){be=courseStructure.pages.length,P.bookmark=P.bookmark_main,fe=ke,P.structure=courseStructure,Ce=ye,u(P.structure.pages),$("#container").attr("data-style","course"),C(P.bookmark),$(".mainPage").css({display:"none"})}),r.eq(2).on("click",function(){$("#container").attr("data-style","video"),S(),$(".mainPage").css({display:"none"})}),r.eq(3).on("click",function(){$("#container").attr("data-style","examples"),q(),$(".mainPage").css({display:"none"})}),r.eq(4).on("click",function(){$("#container").attr("data-style","exercises"),y("page_exercises"),$(".mainPage").css({display:"none"})}),r.eq(6).on("click",function(){$(".mainPage").css({display:"none"}),ne.css({display:"none"}),be=courseStructure.pages.length,P.bookmark=P.bookmark_main,fe=ke,P.structure=courseStructure,Ce=ye,u(P.structure.pages),$("#container").attr("data-style","final"),C(P.structure.pages.length-1)}),r.eq(5).on("click",function(){$("#container").attr("data-style","lections"),B(),$(".mainPage").css({display:"none"})}),X.on("click",function(){C(P.bookmark+1)}),Z.on("click",function(){C(P.bookmark-1)}),ee.on("click",function(){P.structure.pages[P.bookmark].chapterIndex!=Ce.length-1&&C(Ce[P.structure.pages[P.bookmark].chapterIndex+1].startPage)}),te.on("click",function(){0!=P.structure.pages[P.bookmark].chapterIndex&&C(Ce[P.structure.pages[P.bookmark].chapterIndex-1].startPage)}),$(".menuBtn").on("click",function(){A||(A=!0,E=!0,z.css("display","block"),l("menu"))}),$(".statsBtn").on("click",function(){A||(A=!0,R=!0,l("stats"),F.fadeToggle(400))}),$(".helpBtn").on("click",function(){h()}),$(".homeBtn").on("click",function(){A&&k();var e=!0;"exercises"==$("#container").attr("data-style")&&(e=confirm("Вы действительно хотите закрыть упражнение?")),e&&(ctrl.coursePage&&ctrl.coursePage.stop(),$("#container").attr("data-style","home"),$(".mainPage").css({display:"block"}),j.innerHTML="")}),$(".menuBtn, .statsBtn, .helpBtn").on("click",function(){Y.css("display","block").animate({opacity:.9},400,function(){$(this).on("click",function(){k()})})}),$(".closeAssetBtn").on("click",function(){k()}),se.on("click",function(){P.coursePage.restart(),k()}),ae.on("click",function(){C(P.bookmark+1)}),re.on("click",function(){P.makeQR(),setTimeout(P.makePDF,400)}),$(".exitBtn").on("click",function(){var e=confirm("Завершить работу с курсом?");e&&(I(),$("#container").empty().append('<div id="end"></div>'),setTimeout(function(){window.close()},2e3))}),c(P.structure.pages)}function o(){if(void 0==L){var e=0,t=0;$e.push({title:courseStructure_intro.chapters[0],startPage:0,status:-1,score:-1});for(var s=0;s<courseStructure_intro.pages.length;s++){if(courseStructure_intro.pages[s].chapterIndex==e&&t++,courseStructure_intro.pages[s].chapterIndex>e){var a={title:courseStructure_intro.chapters_intro[courseStructure_intro.pages[s].chapterIndex],startPage:s,status:-1,score:-1};$e[e].pagesTotal=t,t=1,$e.push(a),e++}s==courseStructure_intro.pages.length-1&&(0==t&&t++,$e[e].pagesTotal=t),courseStructure_intro.pages[s].orderInChapter=t,ve.pages[s].orderInChapter=t}}console.warn("chapters_intro",$e),be=courseStructure_intro.pages.length}function i(e){var t={};t.pages=[];for(var s=0;s<e.length;s++){var a={};a.score=0,0==s?(a.status=1,a.score=100):a.status=0,a.order=s,a.type=e[s].type[0],"ex"!=e[s].type&&"test"!=e[s].type||(a.score=-1),t.pages.push(a)}return t}function c(e){P.interactions=[];for(var t=0,s=0;s<e.length;s++)"ex"==e[s].type&&(P.interactions[s]=t,pipwerks.SCORM.set("cmi.interactions."+t+".id",e[s].title),pipwerks.SCORM.set("cmi.interactions."+t+".type","choice"),t++)}function u(e){for(var t='<ul id="stats-list">',s='<ul class="menu-list">',a=0,r="",n=0;n<fe.pages.length;n++)r=P.structure.pages[n].chapterIndex==a?"current":"",(P.structure.pages[n].chapterIndex>a||0==n)&&(0!=n&&(a++,s+="</ul>"),s+='</li><li class="menu-list_section '+r+'" order="'+a+'"><div class="menu-list_section_title"><div class="menu-list_section_plus">+</div>'+Ce[a].title+'<div class="menu-list_section_status"></div></div><ul class="menu-list_pages">'),s+='<li order="'+fe.pages[n].order+'" type ="'+fe.pages[n].type+'" class="',n==P.bookmark&&(s+="current "),s+=' menu-list_page"><div class="menu-item-status"></div><div class="menu-item-num">'+fe.pages[n].orderInChapter+".</div><p>"+e[n].title+"</p></li>","e"==fe.pages[n].type&&(t+='<li order="'+fe.pages[n].order+'" type ="'+fe.pages[n].type+'"><div class="stats-item-status"></div><p>'+e[n].title+"</p></li>");s+="</ul></li></ul>",t+="</ul>",$("#menu-body").html("").append(s),$("#stats-exs").html("").append(t),$(".menu-list_section").each(function(e,t){$(t).hasClass("current")?$(t).find(".menu-list_section_plus").addClass("minus").html("—"):$(t).find(".menu-list_pages").slideToggle(0)}),$(".menu-list_section").on("click",function(){var e=$(this);e.hasClass("current")||$(".menu-list_section").each(function(t,s){if($(s).hasClass("current"))return $(s).removeClass("current").find(".menu-list_pages").slideToggle(400,function(){e.addClass("current").find(".menu-list_pages").slideToggle(400),e.find(".menu-list_section_plus").addClass("minus").html("—")}),$(s).find(".menu-list_section_plus").removeClass("minus").html("+"),!1})}),$(".menu-list_page, #stats-list li").on("click",function(e){C($(this).attr("order"))})}function l(e){switch(e){case"menu":var t=$(".menu-list_page");t.removeClass("current");var s=".menu-item-status";$(".menu-list_section").each(function(e,t){$(t).removeClass("current").find(".menu-list_section_plus").removeClass("minus").html("+")}),$(".menu-list_section").eq(P.structure.pages[P.bookmark].chapterIndex).addClass("current").find(".menu-list_section_plus").addClass("minus").html("—"),$(".menu-list_section_status").each(function(e,t){switch($(t).removeClass("clean yellow green red"),Ce[e].status){case-1:$(t).addClass("clean").attr("jqtitle","Тестирование не проходилось");break;case 0:$(t).addClass("red").attr("jqtitle","Тест не пройден");break;case 1:$(t).addClass("yellow").attr("jqtitle","Тест пройден");break;case 2:$(t).addClass("green").attr("jqtitle","Тест пройден отлично")}});break;case"stats":var t=$("#stats-list").find("li"),s=".stats-item-status",a=d();a.exs.done>0&&$("#stats-msg").text("Упражнений выполнено: "+a.exs.done+" из "+a.exs.num),K.progressbar("value",a.exs.res),K.find(".progress-label")[0].innerHTML=Math.floor(a.exs.res)+"%",W.progressbar("value",a.tests.res),W.find(".progress-label")[0].innerHTML=Math.floor(a.tests.res)+"%"}$(".menu-list_pages").css({display:"none"});for(var r,n,o=0;o<t.length;o++)r=$(t[o]),o==P.bookmark&&(r.addClass("current").parent().css({display:"block"}),n=r),"s"!=r.attr("type")&&"c"!=r.attr("type")||1!=fe.pages[Number(r.attr("order"))].status||r.find(s).addClass("visited"),"e"!=r.attr("type")&&"t"!=r.attr("type")||(1==fe.pages[Number(r.attr("order"))].status?r.find(s).addClass("complited"):fe.pages[Number(r.attr("order"))].status==-1&&r.find(s).addClass("failed"));$("#menu-body").scrollTop($(n).offset().top-150)}function d(){for(var e=0,t=0,s=0,a=0,r=0,n=0,o=0,i=0,c=0,u=0;u<fe.pages.length;u++)"e"==fe.pages[u].type&&(fe.pages[u].score>0&&(e+=fe.pages[u].score),1==fe.pages[u].status&&a++,t++),"t"==fe.pages[u].type&&(fe.pages[u].score>0&&(r+=fe.pages[u].score),1==fe.pages[u].status&&i++,fe.pages[u].testId==P.questionList.length-1&&(c=fe.pages[u].score),n++);return t>0&&(s=e/t),n>0&&(o=r/n),{exs:{num:t,res:s,done:a},tests:{num:n,res:o,done:i,finTestScore:c}}}function p(){z.css("display","none"),E=!1}function m(){F.fadeToggle(400),R=!1}function g(){$(".againBtn, .continueBtn, .printCertBtn").removeAttr("style"),J.fadeToggle(400),O=!1}function f(){V.fadeToggle(400),N=!1}function k(){E&&p(),R&&m(),O&&g(),N&&f(),Y.animate({opacity:0},400,function(){$(this).css("display","none").off()}),A=!1}function v(e,t,s,a,r){A&&k(),O=!0,A=!0,a&&(se.css("display","none"),ae.css("display","none")),P.bookmark==P.structure.pages.length-1&&re.css("display","inline-block"),$(".feedback_headComment").text(r),J.stop().fadeToggle(400).find("#feedback-body").html(s),Y.css("display","block").animate({opacity:.9},400,function(){$(this).on("click",function(){k()})})}function h(){A||(A=!0,N=!0,V.fadeToggle(400),Y.css("display","block").animate({opacity:.9},400,function(){$(this).on("click",function(){k()})}))}function b(){for(var e=0,t=0;t<fe.pages.length&&!(fe.pages[t].status<1);t++)e++;G.slider("value",e)}function C(e){var e=Number(e);if(!(e<0||e>be-1||e>0&&P.strongNavigation&&fe.pages[e-1].score<P.pageSuccessScore)){"s"==fe.pages[e].type&&(fe.pages[e].status=1,fe.pages[e].score=100),e==Ce[P.structure.pages[e].chapterIndex].startPage?(X.removeClass("disabled"),Z.addClass("disabled")):P.structure.pages[e].chapterIndex==Ce.length-1&&e==P.structure.pages.length-1?(X.addClass("disabled"),Z.removeClass("disabled")):P.structure.pages[e].chapterIndex!=Ce.length-1&&(X.removeClass("disabled"),Z.removeClass("disabled"),P.structure.pages[e].chapterIndex!=P.structure.pages[e+1].chapterIndex&&(X.addClass("disabled"),Z.removeClass("disabled"))),1==Ce[P.structure.pages[e].chapterIndex].pagesTotal&&(X.addClass("disabled"),Z.addClass("disabled")),0==P.structure.pages[e].chapterIndex?(ee.removeClass("disabled"),te.addClass("disabled")):P.structure.pages[e].chapterIndex==Ce.length-1?(ee.addClass("disabled"),te.removeClass("disabled")):(ee.removeClass("disabled"),te.removeClass("disabled")),A&&k(),D.text(String(fe.pages[e].orderInChapter)+"/"+String(Ce[P.structure.pages[e].chapterIndex].pagesTotal)),ctrl.coursePage&&ctrl.coursePage.stop();var t=document.getElementById(me);t&&j.removeChild(t),j.innerHTML="","intro"==$("#container").attr("data-style")?P.bookmark_intro=P.bookmark=e:P.bookmark_main=P.bookmark=e,$(U).find("p").text(P.structure.pages[e].title),oe.addClass("disabled"),$(".audioCtrl_soundBtn, .audioCtrl_soundBtn25, .audioCtrl_soundBtn50, .audioCtrl_soundBtn75, .audioCtrl_soundBtn100, .audioCtrl_play, .audioCtrl_bg").addClass("disabled"),$(".audioCtrl_play").removeClass("pause"),pe.slider("value",0),H=!1,pe.addClass("disabled"),b(),ne.css("display","block"),"t"==fe.pages[e].type?w():P.structure.pages[e].video?S(P.structure.pages[e].video_width,P.structure.pages[e].video_height,P.structure.pages[e].video,P.structure.pages[e].video_poster):x(),I()}}function y(e){function t(){clearInterval(Q),ne.css("display","none")}var s=document.getElementById(me);s&&j.removeChild(s),j.innerHTML="",oe.addClass("disabled"),$(".audioCtrl_slider").slider("disable"),ne.css("display","block");var a=document.createElement("iframe");a.addEventListener?a.addEventListener("load",t,!1):a.attachEvent?a.attachEvent("onload",t):a.onload=t,a.src="pages/"+e+"/index.html",a.name=me,a.width=a.height="100%",a.frameBorder="0",j.appendChild(a)}function w(){ne.css("display","none"),j.innerHTML=ctrl.templates.test,ctrl.makeMeTestQuestionList(),ctrl.makeTask(window.document,ctrl.currentQuest,!1),$(".testTitle").html(P.structure.pages[P.bookmark].title),P.bookmark==P.structure.pages.length-1?($(".prefinaltestpage").css("display","block"),$("#task-container").css("display","none")):$("#task-container").css("display","block"),ctrl.coursePage={stop:function(){ctrl.coursePage=null},restart:function(){ctrl.makeMeTestQuestionList(),ctrl.makeTask(window.document,ctrl.currentQuest,!1)}}}function x(){function e(){$(".audioCtrl_slider").slider("value",100*ctrl.volume).slider("enable"),$(".audioCtrl_soundBtn, .audioCtrl_soundBtn25, .audioCtrl_soundBtn50, .audioCtrl_soundBtn75, .audioCtrl_soundBtn100, .audioCtrl_play, .audioCtrl_bg").removeClass("disabled"),pe.removeClass("disabled"),t.volume=ctrl.volume,t.play()}j.innerHTML=ctrl.templates.page,j.querySelector(".container").innerHTML='<img class="simplePage_img" src="pages/'+ctrl.structure.pages[ctrl.bookmark].image+'"><audio class="simplePage_audio" src="pages/'+ctrl.structure.pages[ctrl.bookmark].sound+'"></audio>';var t=document.querySelector(".simplePage_audio");H=!0,pe.slider("value",0),t.addEventListener("ended",function(){C(P.bookmark+1)}),t.addEventListener("timeupdate",function(){H&&pe.slider("value",t.currentTime/t.duration*100)}),e(),ctrl.coursePage={play:function(){e()},stop:function(){ctrl.coursePage=null},restart:function(){},soundCtrl:function(e,s){switch(e){case"play":t.play();break;case"pause":t.pause();break;case"volume":0==s?ctrl.volume=t.volume=0:ctrl.volume=t.volume=s/100;break;case"seek":t.currentTime=t.duration*s/100}}}}function S(e,t,s,a){e&&void 0!=e&&"undefined"!=e||(e="940"),t&&void 0!=t&&"undefined"!=t||(t="589"),s&&void 0!=s&&"undefined"!=s||(s="video/Video_READY_2017-02-02.mp4"),a&&void 0!=a&&"undefined"!=a||(a="video/myPoster.jpg"),j.innerHTML=ctrl.templates.videoPage;var r=document.createElement("DIV");r.setAttribute("class","hack-ie-video-block"),j.querySelector(".container").appendChild(r);var n=document.createElement("VIDEO");n.setAttribute("id","example_video_1"),n.setAttribute("class","video-js vjs-default-skin"),n.setAttribute("preload","none"),n.setAttribute("width",e),n.setAttribute("height",t),n.setAttribute("controls",!0),n.setAttribute("poster",a),n.setAttribute("data-setup",'{ "html5" : { "nativeTextTracks" : false } }');var o=document.createElement("SOURCE");o.setAttribute("src",s),j.querySelector(".container").appendChild(n),n.appendChild(o),videojs("example_video_1",{},function(){}),ctrl.coursePage={stop:function(){videojs("example_video_1").dispose(),ctrl.coursePage=null},restart:function(){}}}function q(){j.innerHTML=ctrl.templates.examples,$(".animation-href").off("click").on("click",function(){var e=940,t=589,s=$(this).attr("data-href"),a=$(this).attr("data-poster");S(e,t,s,a),$("#container").attr("data-style","examples_in")}),$(".exBack").off("click").on("click",function(){videojs("example_video_1").dispose(),ctrl.coursePage=null,$("#container").attr("data-style","examples"),q()})}function B(){j.innerHTML=ctrl.templates.addMaterials,$(".add-materials-href").off("click").on("click",function(){$("#container").attr("data-style","add-materials_in"),T($(this).attr("data-href"))}),$(".exBack").off("click").on("click",function(){$("#container").attr("data-style","add-materials"),B()})}function T(e){j.innerHTML=ctrl.templates.objectPage,$(".object-page_text_link").attr("href",e)}function I(){ke.bookmark=P.bookmark_main,ke.chapters=ye,ke.learner=P.learner,ke.age=P.learner_age,ve.bookmark=P.bookmark_intro,ve.chapters=$e,course_data={},course_data.suspend_main=ke,course_data.suspend_intro=ve;try{localStorage.setItem("rosstat_data",JSON.stringify(course_data))}catch(e){}P.success&&(pipwerks.SCORM.set("cmi.location",String(P.bookmark)),pipwerks.SCORM.set("cmi.suspend_data",JSON.stringify(fe)),he=d().tests.finTestScore,pipwerks.SCORM.set("cmi.score.raw",String(he)),he>=P.successScore?pipwerks.SCORM.set("cmi.completion_status","completed"):pipwerks.SCORM.set("cmi.completion_status","incomplete"),pipwerks.SCORM.save())}var P=this;P.structure,P.bookmark=0,P.bookmark_main=0,P.bookmark_intro=0,P.successScore=80,P.pageSuccessScore=1,P.strongNavigation=!1,P.volume=.75,P.learner="Имя обучаемого",P.learner_age=0,P.templates={},P.pdfvars={},P.pdfvars.region="",P.pdfvars.surname="",P.pdfvars.name="",P.pdfvars.patronymiс="",P.pdfvars.age="",P.sendResult=function(e,t,s,a,r){fe.pages[P.bookmark].status=e,fe.pages[P.bookmark].score=t,b(),"c"!=fe.pages[P.bookmark].type&&("t"!=fe.pages[P.bookmark].type&&pipwerks.SCORM.set("cmi.interactions."+P.interactions[P.bookmark]+".result",String(t)),v(e,t,s,a,r)),"t"==fe.pages[P.bookmark].type?fe.pages[P.bookmark].score>P.SuccessScore&&X.removeClass("disabled").removeAttr("jqtitle"):fe.pages[P.bookmark].score>P.pageSuccessScore&&X.removeClass("disabled").removeAttr("jqtitle"),I()},P.makeMeTestQuestionList=function(){function e(e){var t={};return $.extend(!0,t,e)}for(var t=[],s=0;s<M.tests.length;s++){t[s]={questions:[]};for(var a=0;a<M.tests[s].groups.length;a++){var r="";r="all"==M.tests[s].groups[a].qUse?M.tests[s].groups[a].questions.length:M.tests[s].groups[a].qUse,t[s].questions=t[s].questions.concat(_.map(_.sample(M.tests[s].groups[a].questions,r),e)),t[s].givenAnswer=[]}}P.questionList=t.slice(0,t.length),P.currentQuest=0,P.testScore=0},P.makeTask=function(e,s,a){var r=$(e).find("#task-body"),n=P.questionList[P.structure.pages[P.bookmark].testId].questions,o=n[s].type,i="",c=$(e).find(".test_questions_panel"),u=c.find(".test_questions_panel_body");switch(o){case"single":o="radio";break;case"multi":o="box"}r.empty(),r.append('<p id="test-quest-num">Вопрос '+Number(s+1)+" из "+n.length+"</p>"),i="radio"==o?"Выберите один ответ.":"Выберите один или несколько ответов.",r.append('<p id="test-quest-txt">'+n[s].question+"<br/><span>"+i+"</span></p>"),u.empty();for(var l="",d=0;d<n.length;d++)l+='<div class="test_questions_panel_question '+n[d].status,s==d&&(l+=" current"),l+='" order="'+d+'">Вопрос № '+Number(d+1),a&&(l+='<div class="test_questions_panel_question_status ',l+=100==n[d].score?'completed">':'incomplete">'),l+="</div></div>";if(u.append(l),a){var p=P.questionList[P.structure.pages[P.bookmark].testId].givenAnswer[s].answers;console.log("не мешаем",p);for(var d=0;d<p.length;d++)r.append('<div class="answer" right="'+p[d].right+'">'+p[d].label+'<div class="check-item '+o+'"></div></div>')}else{$(e).find(".test_questions_panel_question").off().on("click",function(){var s=Number($(this).attr("order"));s!=P.currentQuest&&"answered"!=n[s].status&&(n[P.currentQuest].status="passed",t(e,s))}),$(e).find(".test_questions_panel_btn").off().on("click",function(){$(".test_questions_panel").toggleClass("active")});for(var p=_.shuffle(n[s].answers),d=0;d<p.length;d++)r.append('<div class="answer" right="'+p[d].right+'">'+p[d].label+'<div class="check-item '+o+'"></div></div>')}$(".prefinaltestpage_readyBtn").click(function(){var e=!0,t=$(".prefinaltestpage").find("input");t.each(function(t,s){""==s.value&&($(".prefinaltestpage_warn").text("Заполнены не все поля."),e=!1,$(s).css({"box-shadow":"0 0 5px red"}))}).off("change").on("change",function(){$(this).removeAttr("style")}),e&&(P.pdfvars.region=t.eq(0)[0].value,P.pdfvars.surname=t.eq(1)[0].value,P.pdfvars.name=t.eq(2)[0].value,P.pdfvars.patronymiс=t.eq(3)[0].value,P.pdfvars.age=t.eq(4)[0].value,$(".prefinaltestpage").css("display","none"),$("#task-container").css("display","block"))}),P.makeTestTask(e,o)},P.makeTestTask=function(s,a){function r(){"radio"==a?(c.removeClass("selected"),$(this).addClass("selected")):$(this).hasClass("selected")?$(this).removeClass("selected"):$(this).addClass("selected");var e=!1;c.each(function(t,s){$(s).hasClass("selected")&&(e=!0)}),e?n.attr("disabled",!1).removeClass("disabled"):n.attr("disabled",!0).addClass("disabled")}var n=$(s).find(".test_answBtn"),o=$(s).find(".test_passBtn"),i=$(s).find(".test_restartBtn"),c=$(s).find(".answer");n.off("click").on("click",function(){e(s,c)}).addClass("disabled").attr("disabled",!0),o.off("click").on("click",function(){P.questionList[P.structure.pages[P.bookmark].testId].questions[P.currentQuest].status="passed",P.currentQuest++,t(s,-1)}),i.off("click").on("click",function(){ctrl.makeMeTestQuestionList(),ctrl.makeTask(window.document,ctrl.currentQuest,!1),o.removeClass("disabled").removeAttr("disabled")}),c.off("click").on("click",r)},P.makePDF=function(){var e=document.querySelector("#qrHolder img").src,t=new Date,s=String(t.getHours()),a=String(t.getMinutes()),r=String(t.getSeconds()),n=String(t.getDate()),o=String(t.getMonth()+1),i=t.getFullYear(),c="ТЕСТ НЕ ПРОЙДЕН";s.length<2&&(s="0"+s),a.length<2&&(a="0"+a),r.length<2&&(r="0"+r),n.length<2&&(n="0"+n),o.length<2&&(o="0"+o),fe.pages[P.bookmark].score>80&&(c="ТЕСТ ПРОЙДЕН");var u={content:[{text:"Федеральная служба государственной статистики",fontSize:10,margin:[0,0,0,20],alignment:"center"},{text:["Выборочное наблюдение доходов населения и участия в"],alignment:"center"},{text:["социальных программах в 2017 году"],alignment:"center"},{text:["ОТЧЁТ О РЕЗУЛЬТАТАХ ТЕСТИРОВАНИЯ"],fontSize:20,width:400,margin:[0,70],alignment:"center"},{columns:[["Наименование субъекта","Российской Федерации:",{text:P.pdfvars.region,margin:[0,10]},"Дата прохождения теста:",{text:n+"."+o+"."+i,margin:[0,0,0,30]},"Фамилия:",{text:P.pdfvars.surname,bold:1,margin:[0,0,0,5]},"Имя:",{text:P.pdfvars.name,bold:1,margin:[0,0,0,5]},"Отчество:",{text:P.pdfvars.patronymiс,bold:1,margin:[0,0,0,5]},"Возраст:",{text:P.pdfvars.age,bold:1,margin:[0,0,0,5]}],{width:200,image:e}]},{text:"Правильных ответов на вопросы итогового теста: "+fe.pages[P.bookmark].score+" из 100",margin:[0,20,0,30]},{text:"Результат:"},{text:c,alignment:"center",fontSize:20,bold:1,margin:[0,20,0,0]}],footer:{text:"Дата и время формирования отчёта: "+n+"."+o+"."+i+" "+s+":"+a,fontSize:8,alignment:"center"}};pdfMake.createPdf(u).download("coursePDF.pdf")},P.makeQR=function(e){e=P.pdfvars.region+"\n"+P.pdfvars.surname+"\n"+P.pdfvars.name+"\n"+P.pdfvars.patronymiс+"\nТест пройден: "+fe.pages[P.bookmark].score;new QRCode(document.getElementById("qrHolder"),{text:String(e),height:300,width:300,colordark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.H})},P.startCourse=function(){if(document.getElementById("container").style.display="block",pipwerks.SCORM.version="2004",P.success=pipwerks.SCORM.init(),P.success){document.getElementById("hello").innerHTML="";var e=pipwerks.SCORM.get("cmi.completion_status");e&&(_e=e),e=pipwerks.SCORM.get("cmi.location"),(e||void 0!=e||"undefinded"!=e||"NaN"!=e)&&(P.bookmark=Number(e)),e=pipwerks.SCORM.get("cmi.suspend_data"),e&&e.length>0&&(fe=JSON.parse(e)),e=pipwerks.SCORM.get("cmi.score.raw"),e&&e.length>0&&(he=e),he>=P.successScore&&(P.learner=pipwerks.SCORM.get("cmi.learner_name"))}else document.getElementById("hello").innerHTML="";r()};var M,L,Q,A=!1,E=!1,R=!1,O=!1,N=!1,H=!0,j=document.getElementById("page-container"),U=document.getElementById("page-title"),D=$(".paginator"),z=$("#menu"),F=$("#stats"),J=$("#feedback"),V=$("#help"),Y=$("#dark"),G=$("#progress-bar"),K=$("#stats-progress"),W=$("#tests-progress"),X=$(".nextBtn"),Z=$(".prevBtn"),ee=$(".nextChapBtn"),te=$(".prevChapBtn"),se=$(".againBtn"),ae=$(".continueBtn"),re=$(".printCertBtn"),ne=$("#page-preloader"),oe=($(".preload-wheel"),$(".audioCtrl_soundBtn")),ie=$(".audioCtrl_soundBtn25"),ce=$(".audioCtrl_soundBtn50"),ue=$(".audioCtrl_soundBtn75"),le=$(".audioCtrl_soundBtn100"),de=$(".audioCtrl_bg"),pe=$(".audioCtrl_progress"),me="myframe",ge="",fe="",ke="",ve="",he=0,_e="incomplete",be=0,Ce=[],$e=[],ye=[],we=75,xe="vol_75";window.addEventListener?window.addEventListener("load",a,!1):window.attachEvent?window.attachEvent("onload",a):window.onload=a}var ctrl=new Ctrl;