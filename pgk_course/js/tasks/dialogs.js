!function(a,b){"use strict";function h(b){a(f).hasClass("active")?(a(parent.frames.myframe.document).find(".slide-block").slideDown(),a(f).removeClass("active"),a(g).removeClass("activated"),a(parent.frames.myframe.document).find(".dialog__wrapper").attr("style","display: none")):(a(parent.frames.myframe.document).find(".slide-block").slideUp(),a(f).addClass("active"),a(g).addClass("activated"),a(parent.frames.myframe.document).find(".dialog__wrapper").removeAttr("style")),0===e&&i(),e++}function i(){var b=a(parent.frames.myframe.document).find(".animate");if(0!==b.length)for(var c=0;c<b.length;c++)a(b[c]).animate({opacity:0},0).delay(2e3*(c+1)).animate({opacity:1},500)}function o(e,f){m=f.draggable,l=a(m[0]).clone().addClass("clone").appendTo(a(parent.frames.myframe.document).find(".dialog__wrapper")),m.addClass("unvisible");var g=a(k[0]).find(".dialog__item"),h=a(l[0]).find(".dialog__item");h.context.style.position="absolute",h.context.style.top=g.offset().top+"px",h.context.style.left=g.offset().left+"px",j.draggable({disabled:!0});for(var i=0;i<d.length;i++)if(a(m).attr("id")==d[i])return b.sendResult(1,100,'<p class="feedback__text">'+c[parseFloat(a(m).attr("id"))-1]+"</p>");return b.sendResult(-1,0,'<p class="feedback__text">'+c[parseFloat(a(m).attr("id"))-1]+"</p>")}function p(){a(l).remove(),a(m).removeClass("unvisible"),j=a(parent.frames.myframe.document).find(".item");for(var c=0;c<j.length;c++)if(Math.random()<.5&&0!==c){var d=a(j[c]).attr("src"),e=a(j[c]).attr("id");a(j[c]).attr("src",a.trim(a(j[c-1]).attr("src"))).attr("id",a.trim(a(j[c-1]).attr("id"))),a(j[c-1]).attr("src",a.trim(d)).attr("id",a.trim(e))}else if(c!==j.length-1){var d=a(j[c]).attr("src"),e=a(j[c]).attr("id");a(j[c]).attr("src",a.trim(a(j[c+1]).attr("src"))).attr("id",a.trim(a(j[c+1]).attr("id"))),a(j[c+1]).attr("src",a.trim(d)).attr("id",a.trim(e))}j.draggable({disabled:!1}),j.load()}var c=b.structure.pages[b.bookmark].messages,d=b.structure.pages[b.bookmark].answers.split(","),e=0,f=a(parent.frames.myframe.document).find(".slide-block__arrow");f.on("click",h);var g=a(parent.frames.myframe.document).find(".slide-block__toggle"),j=a(parent.frames.myframe.document).find(".item");j.draggable({zIndex:2,containment:"document",revert:!0});var k=a(parent.frames.myframe.document).find(".basket");k.droppable({drop:o});var l,m,n=a(parent.frames.myframe.document).find(".btn--restart");n.on("click",p),b.coursePage={play:function(){p()},stop:function(){a(f).off("click"),n.off("click"),j.draggable("destroy"),k.droppable("destroy"),b.coursePage=null},restart:function(){p()}}}(parent.jQuery,parent.ctrl),parent.ctrl.coursePage.play();