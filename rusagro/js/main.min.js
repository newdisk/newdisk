"use strict";!function(){function t(t,e){t.state("contents",{url:"/contents",views:{header:{templateUrl:"js/components/header/headerContentsTmpl.html",controller:"HeaderContentsCtrl",controllerAs:"$ctrl"},content:{templateUrl:"pages/contents/index.html"}}}).state("page",{url:"/chapter/:module/page/:path",views:{header:{templateUrl:"js/components/header/headerTmpl.html",controller:"HeaderCtrl",controllerAs:"$ctrl"},content:{templateUrl:function(t){return"pages/"+(Number(t.module)>9?"chapter"+t.module:"chapter0"+t.module)+"/"+(Number(t.path)>9?"page"+t.path:"page0"+t.path)+"/index.html"},controller:"PageCtrl",controllerAs:"$ctrl"},footer:{templateUrl:"js/components/footer/footerTmpl.html",controller:"FooterCtrl",controllerAs:"$ctrl"}}}),e.otherwise("/contents")}function e(t,e,r,n){t.$on("$stateChangeStart",function(t,e,r,a,s,o){n.closeModal(),n.stopAudio(!0),n.setAudioTime(0)}),t.$on("$stateChangeSuccess",function(t,r,a,s,o,i){e(function(){n.stopAudio(!1)},100)})}t.$inject=["$stateProvider","$urlRouterProvider"],e.$inject=["$rootScope","$timeout","$state","staticService"],angular.module("app",["ui.router","ngSanitize","ngAnimate"]).constant("courseDataObj",courseStructure).constant("testDataObj",testStructure).config(t).run(e)}(),function(){function t(t,e,r,n){var a=[{type:"navModal",state:!1},{type:"glossaryModal",state:!1},{type:"statisticsModal",state:!1},{type:"exerciseModal",state:!1,title:"",answer:"",comment:"",img:""},{type:"addInfoModal",state:!1,content:""},{type:"zoomImg",state:!1,src:"",alt:""}],s=0,o=!1;this.getCourseName=function(){return{course:r.course,description:r.description}},this.getChapterObj=function(t){return r.chapters[t]},this.showModal=function(t,e,n,s,o){var i=a.filter(function(e,r,n){return e.type===t}),l=a.indexOf(i[0]);a[l].state=!a[l].state,void 0!==e&&(a[l].title=n?"Правильный ответ":"Неправильный ответ",a[l].answer="",a[l].comment=r.chapters[s].pages[o].messages[e],e===r.chapters[s].pages[o].data.attempts?a[l].img="last-attempt":a[l].img=n?"true":"false")},this.getExerciseData=function(){return{title:a[3].title,comment:a[3].comment,img:a[3].img}},this.getModalState=function(t){return a[t].state},this.closeModal=function(){a.forEach(function(t,e,r){t.state=!1})},this.getPageAmount=function(t){return r.chapters[t].pages.length},this.addInfo=function(t,e,r){a[4].content=t,a[4].state=e,a[4].heading=r},this.getAddInfo=function(){return a[4]},this.zoomPicture=function(t,e,r){a[5].src=t,a[5].alt=e,a[5].state=r},this.getZoomPicture=function(){return a[5]},this.setAudioTime=function(t){s=t},this.getAudioTime=function(){return s},this.stopAudio=function(t){o=t},this.getStopAudio=function(){return o};var i=!1;this.startAudio=function(t){if(0===arguments.length)return i;i=t},this.getExerciseObject=function(t){return r.chapters[t.module-1].pages[t.path-1].data},this.getData=function(t,e){return r.chapters[t.module-1].pages[t.path-1].data[e]},this.getTestData=function(t){return n.chapters[t.module-1].pages.filter(function(e){return e.id===Number(t.path)})[0].data},this.getMessage=function(t,e){return r.chapters[t.module-1].pages[t.path-1].messages[e]}}t.$inject=["$document","$timeout","courseDataObj","testDataObj"],angular.module("app").service("staticService",t)}(),function(){function t(t,e){var r=t.chapters.map(function(t){return{id:t.id,visited:1,completed:!1,pages:t.pages.map(function(t,e){return{id:t.id,type:t.type,title:t.title,visited:0===e,completed:""}})}});this.getPageProgress=function(t){return{visited:r[t].visited,completed:r[t].completed}},this.getPageVisit=function(t,e){return r[t].pages[e].visited},this.setPageVisit=function(t,e){r[t].pages[e].visited=!0,r[t].visited=r[t].visited>e?r[t].visited:e+1},this.getExerciseArray=function(t){return r[t].pages.filter(function(t){return"complex_page"===t.type||"exercise"===t.type||"test"===t.type})},this.setUserProgress=function(t,e,n){r[e].pages[n].completed=t,0===_.filter(r[e].pages,function(t){if(("complex_page"===t.type||"exercise"===t.type||"test"===t.type)&&!0!==t.completed)return!0}).length&&(r[e].completed=!0)}}t.$inject=["courseDataObj","$document"],angular.module("app").service("userService",t)}(),function(){function t(t,e,r,n,a){var s=this;s.$onInit=function(){t({method:"GET",url:"img/svg-sprite.svg",cache:!0}).then(function(t){s.svgSprite=e.trustAsHtml(t.data)},function(t){console.log("error svg sprite didn't load...")})},s.showModal=function(t){return n.getModalState(t)},s.visitedPage=function(t){return a.getPageProgress(Number(t)-1).visited},s.completedPage=function(t){return a.getPageProgress(Number(t)-1).completed}}t.$inject=["$http","$sce","$stateParams","staticService","userService"],angular.module("app").controller("CourseCtrl",t)}(),function(){function t(t,e){var r=this;r.tabNum=1,r.getAudioTime=function(){return e.getAudioTime()},r.startAnimation=function(){return e.startAudio(!0),r.animationBtnState=!r.animationBtnState}}t.$inject=["$document","staticService"],angular.module("app").controller("PageCtrl",t)}(),function(){function t(t,e,r){var n=this,a=[];n.addPanel=function(t){return a.push(t),"true"!==r.firstOpen||t!==a[0]},n.selectPanel=function(t,e){for(var r in a)t===a[r]&&e?a[r].turnOn():a[r].turnOff()}}function e(t,e,r){var n=this;t.isCollapsed=!0,n.$onInit=function(){t.isCollapsed=n.parent.addPanel(n)},n.turnOn=function(){t.isCollapsed=!1},n.turnOff=function(){t.isCollapsed=!0},t.toggle=function(){n.parent.selectPanel(n,t.isCollapsed)}}function r(t,e,r,n){function a(){console.log($(o).find("img").height());var t=s();o.style.height="auto";var e=s();return o.style.height=t,s(),e}function s(){return o.offsetHeight}var o=r[0],i=0;e.$watch(n.collapse,function(t){var e=t?0:1;if(1===e){if(0!==i)return o.style.height=a()+"px";i=1,function(t){setTimeout(function(){return console.log($(t).height()),o.style.height=a()+"px"},50)}(o)}return o.style.height=e+"px"})}t.$inject=["$scope","$element","$attrs"],e.$inject=["$scope","$element","$attrs"],r.$inject=["$document","$scope","$element","$attrs"],angular.module("app").component("accordion",{transclude:!0,template:'<div class="accordion" ng-transclude></div>',controller:"AccordionCtrl",controllerAs:"$ctrl"}).controller("AccordionCtrl",t).component("accordionPanel",{require:{parent:"^accordion"},bindings:{heading:"@"},transclude:!0,templateUrl:"js/components/accordion/accordionPanelTmpl.html",controller:"AccordionPanelCtrl",controllerAs:"$ctrl"}).controller("AccordionPanelCtrl",e).controller("AccordionContentCtrl",r)}(),function(){function t(t,e,r){this.getAddInfo=function(){r.addInfo(e.find("ng-transclude").prop("outerHTML"),!0,t.heading)}}t.$inject=["$attrs","$element","staticService"],angular.module("app").component("addInfo",{bindings:{heading:"@",position:"@"},transclude:!0,templateUrl:"./js/components/add-info/addInfoTmpl.html",controller:"AddInfoCtrl",controllerAs:"$ctrl"}).controller("AddInfoCtrl",t)}(),function(){angular.module("app").component("buttons",{template:'<div class="btn-box"><button class="btn btn_restart" ng-click="$ctrl.removeRestart()">Начать заново</button><button class="btn btn_answer" ng-click="$ctrl.checkAnswer()">Принять ответ</button></div>'})}(),function(){function t(t,e,r,n){angular.element(document).ready(function(){$("carousel-item:first").before($("carousel-item:last")),t.toPrevItem=function(t){var e=$(t.currentTarget);e.css("pointer-events","none");var r=$("carousel-item").outerWidth(),n=parseInt($(".carousel__list").css("left"))+r;$(".carousel__list:not(:animated)").animate({left:n},700,function(){$("carousel-item:first").before($("carousel-item:last")),$(".carousel__list").css({left:"-"+r+"px"}),e.css("pointer-events","auto")})},t.toNextItem=function(t){var e=$(t.currentTarget);e.css("pointer-events","none");var r=$("carousel-item").outerWidth(),n=parseInt($(".carousel__list").css("left"))-r;$(".carousel__list:not(:animated)").animate({left:n},700,function(){$("carousel-item:last").after($("carousel-item:first")),$(".carousel__list").css({left:"-"+r+"px"}),e.css("pointer-events","auto")})},$(window).resize(function(){$(".carousel__list").css({left:"-"+$("carousel-item").outerWidth()+"px"})})})}t.$inject=["$scope","$stateParams","staticService","userService"],angular.module("app").component("carousel",{transclude:!0,template:'<div class="carousel">\n\t\t              <button class="carousel__toggler carousel__toggler_left" ng-click="toPrevItem($event)">\n\t\t              \t<svg viewBox="0 0 50 60" width="50" height="60">\n\t\t\t\t\t\t\t\t\t\t\t<use xmlns:xlink="http://www.w3.org/1999/xlink" \n\t\t\t\t\t\t\t\t\t\t\t\t\t xlink:href="#carousel_arrow-left">\n\t\t\t\t\t\t\t\t\t\t\t</use>\n\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t              </button>\n\t\t                <ul class="carousel__list" ng-transclude>\n\t\t                </ul>\n\t\t              <button class="carousel__toggler carousel__toggler_right" ng-click="toNextItem($event)">\n\t\t              \t<svg viewBox="0 0 50 60" width="50" height="60">\n\t\t\t\t\t\t\t\t\t\t\t<use xmlns:xlink="http://www.w3.org/1999/xlink" \n\t\t\t\t\t\t\t\t\t\t\t\t\t xlink:href="#carousel_arrow-right">\n\t\t\t\t\t\t\t\t\t\t\t</use>\n\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t              </button>\n\t\t             </div>',controller:"carouselCtrl"}).component("carouselItem",{bindings:{src:"@",alt:"@",title:"@"},transclude:!0,template:'<li class="carousel__item">\n\t\t                <img class="carousel__img" ng-src="{{$ctrl.src}}" alt="{{$ctrl.alt}}" width="100%">\n\t\t                <div class="carousel__caption">\n\t\t                  <h3 class="carousel__caption-title">{{$ctrl.title}}</h3>\n\t\t                  <p class="carousel__caption-text" ng-transclude></p>\n\t\t                </div>\n\t\t              </li>'}).controller("carouselCtrl",t)}(),function(){function t(t,e,r){var n=this;n.play="#play",n.mute="#unmute",n.volume=1,n.$onInit=function(){n.audio=t[0].createElement("audio"),n.audio.src="pages/chapter"+n.module+"/page"+n.page+"/audio/page-"+n.module+"-"+n.page+".mp3",n.audio.oncanplaythrough=function(){n.changePlayPause=function(){n.audio.paused?(n.audio.play(),n.play="#pause"):(n.audio.pause(),n.play="#play")},n.updateSeekSlider=function(){var t=n.audio.currentTime*(100/n.audio.duration),e=Math.floor(n.audio.currentTime/60),r=Math.floor(n.audio.currentTime-60*e),a=Math.floor(n.audio.duration/60),s=Math.floor(n.audio.duration-60*a);n.seekPos=Math.floor(t),e<10&&(e="0"+e),r<10&&(r="0"+r),a<10&&(a="0"+a),s<10&&(s="0"+s),n.curTime=e+":"+r,n.durTime=a+":"+s,n.audio.currentTime===n.audio.duration&&(n.play="#play")},n.changeSeekPos=function(){n.audio.currentTime=n.audio.duration*(n.seekPos/100)},e(function(){if(n.audio){if(n.updateSeekSlider(),r.setAudioTime(n.audio.currentTime),r.getStopAudio())return n.audio.pause(),void(n.audio=null);r.startAudio()&&(n.audio.play(),n.play="#pause",r.startAudio(!1))}},100),n.changeMuteState=function(){n.mute="#unmute",n.audio.muted?(n.audio.muted=!1,n.mute="#unmute"):(n.audio.muted=!0,n.mute="#mute")},n.changeVolume=function(){n.audio.volume=n.volume},n.restart=function(){n.audio.currentTime=0,n.audio.play(),n.play="#pause"}}}}t.$inject=["$document","$interval","staticService"],angular.module("app").component("customAudio",{bindings:{module:"@",page:"@"},templateUrl:"js/components/custom-audio/customAudioTmpl.html",controller:"CustomAudioCtrl",controllerAs:"$ctrl"}).controller("CustomAudioCtrl",t)}(),function(){function t(t,e,r,n){var a=this;a.moduleNum=e.module>9?e.module:"0"+e.module,a.pageNum=e.path>9?e.path:"0"+e.path,a.curPageNum=e.path,a.pageAmount=""+r.getPageAmount(Number(e.module)-1),a.toBack=function(){"1"!==a.curPageNum&&t.go("page",{module:e.module,path:Number(a.curPageNum)-1})},a.toForward=function(){a.curPageNum!==a.pageAmount&&(n.setPageVisit(Number(e.module)-1,Number(a.curPageNum)),t.go("page",{module:e.module,path:Number(a.curPageNum)+1}))}}t.$inject=["$state","$stateParams","staticService","userService"],angular.module("app").controller("FooterCtrl",t)}(),function(){function t(t){this.courseTitle=t.getCourseName()}t.$inject=["staticService"],angular.module("app").controller("HeaderContentsCtrl",t)}(),function(){function t(t,e,r){var n=this;n.chapterPages=e.getChapterObj(Number(t.module)-1),n.title={module:n.chapterPages.title,exercise:n.chapterPages.pages[Number(t.path)-1].title},n.showModal=function(t){return e.getModalState(t)},n.getExerciseData=function(){return e.getExerciseData()},n.closeModal=function(){e.closeModal()},n.toggleNavigation=function(){$(this).hasClass("btn_nav-active")?e.closeModal():e.showModal("navModal")},n.toggleGlossary=function(){$(this).hasClass("btn_nav-active")?e.closeModal():e.showModal("glossaryModal")},n.toggleStatistics=function(){$(this).hasClass("btn_nav-active")?e.closeModal():e.showModal("statisticsModal")},n.getUserObj=function(){return r.getExerciseArray(Number(t.module)-1)},n.getCompletedTaskNumber=function(){return r.getExerciseArray(Number(t.module)-1).filter(function(t){return!!t.completed})},n.getPageVisit=function(e){return r.getPageVisit(Number(t.module)-1,Number(e))},n.addInfo=function(){return e.getAddInfo()},n.value=100,n.picture=function(){return e.getZoomPicture()},n.definition=[{term:"5S",description:"система организации и поддержания в порядке вашего рабочего места."},{term:"RACI-матрица ответственности",description:"общая схема распределения персональной ответственности."},{term:"SOP",description:"стандартные операционные процедуры, в которых описана последовательность конкретных шагов в рамках той или иной активности."},{term:"Карта процессов",description:"это схематичный документ, отображающий процессы шаг за шагом, в структурированном виде, разбитый на несколько уровней."},{term:"Макропроцессы",description:"это бизнес-процессы, которые организуют деятельность предприятия на самом высоком уровне. Главный макропроцесс должен быть обязательно связан с продуктом, который производит предприятие."},{term:"Процесс",description:"это любые действия, которые являются средством для превращения входных данных/материалов в продукцию/услуги с целью удовлетворения нужд потребителя/внутреннего клиента."}]}t.$inject=["$stateParams","staticService","userService"],angular.module("app").controller("HeaderCtrl",t)}(),function(){function t(t,e,r,n){var a=this,s=0;a.taskData=r.getExerciseObject(t),a.taskData.userList=[],a.btnDisabledState={restart:!1,answer:!1},angular.element(e).ready(function(){a.getBtnState=function(){return a.btnDisabledState},a.checkAnswer=function(){var e;a.btnDisabledState.answer=!0,s+=1;for(var o=0;o<a.taskData.answerList.length;o++)a.taskData.answerList[o]!==$.trim(a.taskData.userList[o]).replace(".",",")&&(e=!1);if(!1===e){if(s===a.taskData.attempts){if(a.taskData.showAnswer)for(var o=0;o<a.taskData.answerList.length;o++)a.taskData.userList[o]=a.taskData.answerList[o];return s=0,a.btnDisabledState.restart=!0,n.setUserProgress(!1,Number(t.module)-1,Number(t.path)-1),r.showModal("exerciseModal",a.taskData.attempts,!1,Number(t.module)-1,Number(t.path)-1)}return n.setUserProgress(!1,Number(t.module)-1,Number(t.path)-1),r.showModal("exerciseModal",s,!1,Number(t.module)-1,Number(t.path)-1)}return a.btnDisabledState.restart=!0,n.setUserProgress(!0,Number(t.module)-1,Number(t.path)-1),r.showModal("exerciseModal",0,!0,Number(t.module)-1,Number(t.path)-1)},a.removeRestart=function(){a.btnDisabledState.answer=!1,a.taskData.userList=[]}})}t.$inject=["$stateParams","$document","staticService","userService"],angular.module("app").controller("TaskFillingFieldsCtrl",t)}(),function(){function t(t,e,r){var n=this;n.state=!1,n.attemptNum=0,n.showComment=!1,n.taskText=e.getData(t,"taskText"),n.answerList=e.getData(t,"answerList"),angular.element(document).ready(function(){function a(t,e,r,n,a,s,o){var l=-1===t&&0!==a||1===t&&0!==n?500:300,u=e/l,c=r/l,m=n/l,d=a/l,g=Date.now(),p=$(".ranging-blocks").css("pointer-events","none");s.css("z-index","1");var f=setInterval(function(){var e=Date.now()-g;if(e>=l)return clearInterval(f),s[0].style.top="0px",o[0].style.top="0px",t>0?s.after(o):s.before(o),i=$(".ranging-blocks__item"),s.css("z-index","0"),p=$(".ranging-blocks").css("pointer-events","auto"),s.css("margin-top",a+"px"),void o.css("margin-top",n+"px");t>0?(s[0].style.top=-e*(c+m)+"px",o[0].style.top=e*(u+m)+"px"):(s[0].style.top=e*(c+d)+"px",o[0].style.top=-e*(u+d)+"px")},20)}function s(t){return{size:t.outerWidth()-t.innerWidth()+(t.innerWidth()-t.width())+(t.outerWidth(!0)-t.outerWidth())+t.height(),style:Number($(t).css("margin-top").split("px")[0])}}var o,i=$(".ranging-blocks__item"),l=$(".arrow_up"),u=$(".arrow_down");n.toArrowUp=function(t){var e=t.currentTarget,r=$.inArray(e,l);0!==r&&-1!==r&&a(1,s(i.eq(r)).size,s(i.eq(r-1)).size,s(i.eq(r)).style,s(i.eq(r-1)).style,i.eq(r),i.eq(r-1))},n.toArrowDown=function(t){var e=$.inArray(t.currentTarget,u);e!==u.length-1&&-1!==e&&a(-1,s(i.eq(e)).size,s(i.eq(e+1)).size,s(i.eq(e)).style,s(i.eq(e+1)).style,i.eq(e),i.eq(e+1))},n.checkAnswer=function(){for(3===n.attemptNum&&(n.attemptNum=0),n.attemptNum=n.attemptNum+1,o=0;o<i.length;o++)if($(i[o]).attr("data-section")!==n.answerList[o].section)return 3===n.attemptNum&&n.setRightOrder(),r.setUserProgress(!1,Number(t.module)-1,Number(t.path)-1),e.showModal("exerciseModal",n.attemptNum,!1,Number(t.module)-1,Number(t.path)-1);r.setUserProgress(!0,Number(t.module)-1,Number(t.path)-1),e.showModal("exerciseModal",0,!0,Number(t.module)-1,Number(t.path)-1)},n.removeRestart=function(){for(var t,e=[],r=0;r<i.length;r++)e.push(r);for(e=_.shuffle(e),t=e[0],r=1;r<i.length;r++)$(i[t]).after(i[e[r]]),t=e[r];for(i=$(".ranging-blocks__item"),r=0;r<i.length;r++)$(i[r]).css("margin-top",n.answerList[r].marginTop)},n.removeRestart(),n.setRightOrder=function(){}})}t.$inject=["$stateParams","staticService","userService"],angular.module("app").controller("TaskRangingCtrl",t)}(),function(){function t(t,e,r,n,a){var s=this,o=0,i=$(e).find(".sort__content");s.taskData=n.getExerciseObject(t),s.btnDisabledState={restart:!1,answer:!1},$(e).find(".sort").sortable({containment:".sort-wrapper"}),$(".sort").disableSelection(),angular.element(r).ready(function(){function r(){for(var t=1;t<i.length;t++)$(i[t-1]).after(i[t])}s.getBtnState=function(){return s.btnDisabledState},s.checkAnswer=function(){var l=$(e).find(".sort__content");s.btnDisabledState.answer=!0,o+=1;for(var u=0;u<i.length;u++)if($.trim(l[u].innerHTML)!==$.trim(i[u].innerHTML))return o===s.taskData.attempts?(s.taskData.showAnswer&&r(),o=0,s.btnDisabledState.restart=!0,a.setUserProgress(!1,Number(t.module)-1,Number(t.path)-1),n.showModal("exerciseModal",s.taskData.attempts,!1,Number(t.module)-1,Number(t.path)-1)):(a.setUserProgress(!1,Number(t.module)-1,Number(t.path)-1),n.showModal("exerciseModal",o,!1,Number(t.module)-1,Number(t.path)-1));return s.btnDisabledState.restart=!0,a.setUserProgress(!0,Number(t.module)-1,Number(t.path)-1),n.showModal("exerciseModal",0,!0,Number(t.module)-1,Number(t.path)-1)},s.removeRestart=function(){var t,r=$(e).find(".sort__content"),n=[];s.btnDisabledState.answer=!1;for(var a=0;a<r.length;a++)n.push(a);for(s.taskData.shuffle&&(n=_.shuffle(n)),t=n[0],a=1;a<r.length;a++)$(r[t]).after(r[n[a]]),t=n[a]},s.removeRestart()})}t.$inject=["$stateParams","$element","$document","staticService","userService"],angular.module("app").controller("TaskRangingSortCtrl",t)}(),function(){function t(t,e,r){function n(t,e){if(t.classList.contains("fixed"))return void console.warn("drop on fixed");var r=t.parentNode,n=t.nextSibling===e?t:t.nextSibling;e.parentNode.insertBefore(t,e),r.insertBefore(e,n),e.style.left="0px",e.style.top="0px"}function a(){var t=0;for(c=1;c<o.length;c++)$(o[t]).after(o[c]),t=c}var s=this,o=$(".sort").find("div"),i=$(".fixed"),l=[],u=0;if(s.taskData=e.getExerciseObject(t),s.disabledBtn=!1,i.length)for(var c=0;c<o.length;c++)$(o[c]).hasClass("fixed")&&l.push(c);console.log(l),$(".swapable").draggable({zIndex:2,containment:".sort-wrapper",start:function(t,e){},stop:function(t,e){console.log(e),e.helper[0].style.top="0px",e.helper[0].style.left="0px"}}).droppable({drop:function(t,e){n($(this).get(0),$(e.draggable).get(0))}}),s.checkAnswer=function(){var n=$(".sort").find("div");u+=1;for(var i=0;i<o.length;i++)if($(n[i]).index($(o))!==i)return u===s.taskData.attempts?(s.taskData.showAnswer&&(s.disabledBtn=!0,a()),u=0,r.setUserProgress(!1,Number(t.module)-1,Number(t.path)-1),e.showModal("exerciseModal",s.taskData.attempts,!1,Number(t.module)-1,Number(t.path)-1)):(r.setUserProgress(!1,Number(t.module)-1,Number(t.path)-1),e.showModal("exerciseModal",u,!1,Number(t.module)-1,Number(t.path)-1));return s.disabledBtn=!0,r.setUserProgress(!0,Number(t.module)-1,Number(t.path)-1),e.showModal("exerciseModal",0,!0,Number(t.module)-1,Number(t.path)-1)},s.removeRestart=function(){for(var t,e=[],r=0;r<o.length;r++)e.push(r);for(s.taskData.shuffle&&(e=_.shuffle(e)),t=e[0],r=1;r<o.length;r++)$(o[t]).after(o[e[r]]),t=e[r];var n=$(".sort").find("div");if(i.length){for(var r=0;r<i.length;r++)$(n[n.length-1]).after(i[r]);n=$(".sort").find("div");for(var r=0;r<i.length;r++)$(n[l[r]]).before(i[r]),n=$(".sort").find("div")}},s.removeRestart()}t.$inject=["$stateParams","staticService","userService"],angular.module("app").controller("TaskRangingSwapableCtrl",t)}(),function(){angular.module("app").component("taskRangingText",{bindings:{shuffle:"@",lastAttempt:"@",showAnswer:"@"},templateUrl:"js/components/task-ranging/taskRangingTextTmpl.html",controller:"TaskRangingCtrl",controllerAs:"$ctrl"})}(),function(){function t(t,e,r){var n=this;n.state=!1,n.attemptNum=0,n.showComment=!1,n.taskText=e.getData(t,"taskText"),n.answerList=e.getData(t,"answerList"),angular.element(document).ready(function(){function a(t,e,r,n,a,s,o){var l=-1===t&&0!==a||1===t&&0!==n?500:300,u=e/l,c=r/l,m=n/l,d=a/l,g=Date.now(),p=$(".ranging-blocks").css("pointer-events","none");s.css("z-index","1");var f=setInterval(function(){var e=Date.now()-g;if(e>=l)return clearInterval(f),s[0].style.top="0px",o[0].style.top="0px",t>0?s.after(o):s.before(o),i=$(".ranging-blocks__item"),s.css("z-index","0"),p=$(".ranging-blocks").css("pointer-events","auto"),s.css("margin-top",a+"px"),void o.css("margin-top",n+"px");t>0?(s[0].style.top=-e*(c+m)+"px",o[0].style.top=e*(u+m)+"px"):(s[0].style.top=e*(c+d)+"px",o[0].style.top=-e*(u+d)+"px")},20)}function s(t){return{size:t.outerWidth()-t.innerWidth()+(t.innerWidth()-t.width())+(t.outerWidth(!0)-t.outerWidth())+t.height(),style:Number($(t).css("margin-top").split("px")[0])}}var o,i=$(".ranging-blocks__item"),l=$(".arrow_up"),u=$(".arrow_down");n.toArrowUp=function(t){var e=t.currentTarget,r=$.inArray(e,l);0!==r&&-1!==r&&a(1,s(i.eq(r)).size,s(i.eq(r-1)).size,s(i.eq(r)).style,s(i.eq(r-1)).style,i.eq(r),i.eq(r-1))},n.toArrowDown=function(t){var e=$.inArray(t.currentTarget,u);e!==u.length-1&&-1!==e&&a(-1,s(i.eq(e)).size,s(i.eq(e+1)).size,s(i.eq(e)).style,s(i.eq(e+1)).style,i.eq(e),i.eq(e+1))},n.checkAnswer=function(){for(3===n.attemptNum&&(n.attemptNum=0),n.attemptNum=n.attemptNum+1,o=0;o<i.length;o++)if($(i[o]).attr("data-section")!==n.answerList[o].section)return 3===n.attemptNum&&n.setRightOrder(),r.setUserProgress(!1,Number(t.module)-1,Number(t.path)-1),e.showModal("exerciseModal",n.attemptNum,!1,Number(t.module)-1,Number(t.path)-1);r.setUserProgress(!0,Number(t.module)-1,Number(t.path)-1),e.showModal("exerciseModal",0,!0,Number(t.module)-1,Number(t.path)-1)},n.removeRestart=function(){for(var t,e=[],r=0;r<i.length;r++)e.push(r);for(e=_.shuffle(e),t=e[0],r=1;r<i.length;r++)$(i[t]).after(i[e[r]]),t=e[r];for(i=$(".ranging-blocks__item"),r=0;r<i.length;r++)$(i[r]).css("margin-top",n.answerList[r].marginTop)},n.removeRestart(),n.setRightOrder=function(){var t=i.map(function(t,e){return{index:t,rightIndex:$(e).attr("data-section")}});t.sort(function(t,e){return t.rightIndex-e.rightIndex}),console.log("rightOrderedList",t);var e=t[0].index;for(o=1;o<i.length;o++)console.log(i[t[o].index]),$(i[e]).after(i[t[o].index]),e=t[o].index}})}t.$inject=["$stateParams","staticService","userService"],angular.module("app").component("taskRangingTextOl",{bindings:{shuffle:"@",lastAttempt:"@",showAnswer:"@"},templateUrl:"js/components/task-ranging/taskRangingTextOlTmpl.html",controller:"TaskRangingTextCtrl",controllerAs:"$ctrl"}).controller("TaskRangingTextCtrl",t)}(),function(){angular.module("app").component("taskRangingWithShelves",{bindings:{shuffle:"@",lastAttempt:"@",showAnswer:"@"},templateUrl:"js/components/task-ranging/taskRangingWithShelvesTmpl.html",controller:"TaskRangingCtrl",controllerAs:"$ctrl"})}(),function(){function t(t,e,r,n,a){var s=this,o=n.getData(r,"bannerStart"),i=n.getData(r,"bannerEnd"),l=0;s.taskText=n.getData(r,"taskText"),s.imageList=n.getData(r,"imageList"),s.banner=o,s.$onInit=function(){s.lastAttempt=$(t).attr("lastAttempt")},angular.element(e).ready(function(){var t,e=$(".gallery-item");s.check=function(t){s.imageList[t].checkedBlock=!s.imageList[t].checkedBlock},s.checkAnswer=function(){for("none"!==s.lastAttempt&&l!==Number(s.lastAttempt)||(l=0),l+=1,t=0;t<e.length;t++){var o=Number($(e[t]).attr("data-number"));if(s.imageList[o].checkedBlock!==s.imageList[o].needCheckedAns)return a.setUserProgress(!1,Number(r.module)-1,Number(r.path)-1),n.showModal("exerciseModal",l,!1,Number(r.module)-1,Number(r.path)-1)}s.banner=i,a.setUserProgress(!0,Number(r.module)-1,Number(r.path)-1),n.showModal("exerciseModal",0,!0,Number(r.module)-1,Number(r.path)-1)},s.removeRestart=function(){s.banner=o;for(var t,r=[],n=0;n<e.length;n++)r.push(n);for(r=_.shuffle(r),n=0;n<s.imageList.length;n++)s.imageList[n].checkedBlock=!1;for(t=r[0],n=1;n<e.length;n++)$(e[t]).after(e[r[n]]),t=r[n]},s.removeRestart()})}t.$inject=["$element","$document","$stateParams","staticService","userService"],angular.module("app").component("taskImageCheck",{bindings:{shuffle:"@",lastAttempt:"@",showAnswer:"@"},templateUrl:"js/components/task-image-check/taskImageCheckTmpl.html",controller:"TaskImageCheckCtrl",controllerAs:"$ctrl"}).controller("TaskImageCheckCtrl",t)}(),function(){function t(t,e,r,n,a){var s=this,o=0;s.taskData=n.getExerciseObject(t),s.taskText=s.taskData.taskText,s.questionList=s.taskData.questionList,s.stateNum=0,s.btnDisabledState={restart:!1,answer:!1},s.questionList.forEach(function(t){t.state=!1,t.variant.forEach(function(t){t.answer=!1})}),angular.element(e).ready(function(){s.checkVariant=function(t,e){!1===s.questionList[e].state&&(s.stateNum=s.stateNum+1,s.questionList[e].state=!0),s.questionList[e].variant.forEach(function(t){t.answer=!1}),s.questionList[e].variant[t].answer=!0},s.getBtnState=function(){return s.btnDisabledState},s.checkAnswer=function(){s.stateNum=0,s.btnDisabledState.answer=!0,o+=1;for(var e=0;e<s.questionList.length;e++)for(var r=0;r<s.questionList[e].variant.length;r++)if(s.questionList[e].variant[r].rightAnswer!==s.questionList[e].variant[r].answer)return o===s.taskData.attempts?(s.taskData.showAnswer&&s.questionList.forEach(function(t){t.variant.forEach(function(t){t.answer=t.rightAnswer})}),o=0,s.btnDisabledState.restart=!0,a.setUserProgress(!1,Number(t.module)-1,Number(t.path)-1),n.showModal("exerciseModal",s.taskData.attempts,!1,Number(t.module)-1,Number(t.path)-1)):(a.setUserProgress(!1,Number(t.module)-1,Number(t.path)-1),n.showModal("exerciseModal",o,!1,Number(t.module)-1,Number(t.path)-1));return s.btnDisabledState.restart=!0,a.setUserProgress(!0,Number(t.module)-1,Number(t.path)-1),n.showModal("exerciseModal",0,!0,Number(t.module)-1,Number(t.path)-1)},s.removeRestart=function(){var t=$(r).find(".task__single-choice-block");if(s.btnDisabledState.answer=!1,s.questionList.forEach(function(t){t.state=!1,t.variant.forEach(function(t){t.answer=!1})}),s.taskData.shuffle)for(var e=0;e<t.length;e++){for(var n,a=$(t[e]).find(".task__single-choice-item"),o=[],i=0;i<a.length;i++)o[i]=i;o=_.shuffle(o),n=o[0];for(var i=1;i<a.length;i++)$(a[n]).after(a[o[i]]),n=o[i]}},s.removeRestart()})}t.$inject=["$stateParams","$document","$element","staticService","userService"],angular.module("app").component("taskSingleChoice",{templateUrl:"js/components/task-single-choice/taskSingleChoiceTmpl.html",controller:"SingleChoiceCtrl",controllerAs:"$ctrl"}).controller("SingleChoiceCtrl",t)}(),function(){function t(t,e,r){function n(t,e){if(s.currentQuestNum<s.taskList.length-1)s.currentQuestNum++;else for(t=s.taskList.filter(function(t){return!0===t.state}).length,a=0;a<o.length;a++)if(t/s.taskList.length*100>=Number(o[a]))return console.log(t/s.taskList.length*100,o[a]);return t}var a,s=this,o=t.score.split(",");s.currentQuestNum=0,s.taskList=r.getTestData(e),console.log(s.taskList),s.taskList.forEach(function(t){return t.variant.forEach(function(t){return t.answer=!1}),t.state=!1}),s.state=0,s.getCurrentQuestNum=function(){return s.currentQuestNum},s.checkItem=function(t,e){return"single-choice"===s.taskList[e].type&&s.taskList[e].variant.forEach(function(t){return t.answer=!1}),s.taskList[e].variant[t].answer=!s.taskList[e].variant[t].answer,0!==s.taskList[e].variant.filter(function(t){return!0===t.answer}).length?s.state=1:s.state=0},s.checkAnswer=function(){var t,e;t=s.taskList[s.currentQuestNum].variant.filter(function(t){return t.answer!==t.rightAnswer}),0===t.length?(s.taskList[s.currentQuestNum].state=!0,e=n(e,!0)):(s.taskList[s.currentQuestNum].state=!1,e=n(e,!1))},s.removeRestart=function(){s.currentQuestNum=0,s.taskList=_.shuffle(s.taskList),s.taskList.forEach(function(t){return t.state=!1,t.variant.forEach(function(t){return t.answer=!1}),t.variant=_.shuffle(t.variant)})},s.removeRestart()}t.$inject=["$attrs","$stateParams","staticService"],angular.module("app").component("taskTest",{bindings:{score:"@"},templateUrl:"./js/components/task-test/taskTestTmpl.html",controller:"taskTestCtrl",controllerAs:"$ctrl"}).controller("taskTestCtrl",t)}(),function(){function t(t,e,r){var n=this;n.answerList=e.getData(t,"answerList"),n.bannerStart=e.getData(t,"bannerStart"),n.bannerEnd=e.getData(t,"bannerEnd"),n.banner={},n.banner.src=n.bannerStart.src,n.banner.alt=n.bannerStart.alt,n.active=[],n.state=0,n.attemptNum=0;for(var a=0;a<n.answerList.length;a++)n.active[a]={},n.active[a].state=!1,n.active[a].answer="";n.showComment=!1,angular.element(document).ready(function(){n.setColor=function(t,e,r){console.log(t,e,r),!1===n.active[r].state&&(n.state=n.state+1,n.active[r].state=!0),n.active[r].answer=e},n.checkAnswer=function(){3===n.attemptNum&&(n.attemptNum=0),n.attemptNum=n.attemptNum+1;for(var a=0;a<n.answerList.length;a++)if(n.answerList[a].rightAnswer!==Number(n.active[a].answer)){if(3===n.attemptNum)for(var s=0;s<n.questionList.length;s++)n.active[s].state=!0,n.active[s].answer=n.questionList[s].rightAnswer;return r.setUserProgress(!1,Number(t.module)-1,Number(t.path)-1),e.showModal("exerciseModal",n.attemptNum,!1,Number(t.module)-1,Number(t.path)-1)}r.setUserProgress(!0,Number(t.module)-1,Number(t.path)-1),e.showModal("exerciseModal",0,!0,Number(t.module)-1,Number(t.path)-1),n.banner.src=n.bannerEnd.src,n.banner.alt=n.bannerEnd.alt},n.removeRestart=function(){for(var t=0;t<n.active.length;t++)n.active[t].state=!1,n.active[t].answer="";n.state=0,n.banner.src=n.bannerStart.src,n.banner.alt=n.bannerStart.alt}})}t.$inject=["$stateParams","staticService","userService"],angular.module("app").component("taskSingleChoiceImg",{bindings:{shuffle:"@",lastAttempt:"@",showAnswer:"@"},templateUrl:"js/components/task-single-choice-img/taskSingleChoiceImgTmpl.html",controller:"TaskSingleChoiceImgCtrl",controllerAs:"$ctrl"}).controller("TaskSingleChoiceImgCtrl",t)}(),function(){function t(t,e,r,n){var a=this;a.attemptNum=0,a.showComment=!1,a.taskText=r.getData(e,"taskText"),a.cards=r.getData(e,"cards"),angular.element(document).ready(function(){a.state=!1;var s=$(t).find("img"),o=$(t).find(".sortable-box");console.log(t,s,o),$(t).find(".sortable-box").sortable({containment:".task-sortable",connectWith:$(t).find(".sortable-box"),start:function(e,r){r.item.attr("number",$.inArray(this,$(t).find(".sortable-box")))},update:function(e,r){
$(this).find("img").length>1&&!$(this).hasClass("variant-field")&&r.item.appendTo($(t).find(".sortable-box")[r.item.attr("number")]),0===$(t).find(".variant-field").find(".task-sortable__img").length&&(a.state=!0)}}),a.checkAnswer=function(){a.state=!1;for(var s=$(t).find(".box-field").find(".sortable-box"),o=0;o<s.length;o++)if(console.log($(s[o]).find("img").attr("src"),a.cards[o].src),$.trim($(s[o]).find("img").attr("src"))!==$.trim(a.cards[o].src))return n.setUserProgress(!1,Number(e.module)-1,Number(e.path)-1),r.showModal("exerciseModal",1,!1,Number(e.module)-1,Number(e.path)-1);n.setUserProgress(!0,Number(e.module)-1,Number(e.path)-1),r.showModal("exerciseModal",0,!0,Number(e.module)-1,Number(e.path)-1)},a.removeRestart=function(){for(var e=$(t).find("img"),r=$(t).find(".variant-field"),n=1;n<e.length;n++)$(e[n]).appendTo(r);var s,o=[];for(n=0;n<a.cards.length;n++)o[n]=n;for(o=_.shuffle(o),s=o[0],n=1;n<e.length;n++)$(e[s]).after(e[o[n]]),s=o[n]},a.removeRestart()})}t.$inject=["$element","$stateParams","staticService","userService"],angular.module("app").component("taskSortableBoxes",{templateUrl:"js/components/task-sortable-boxes/taskSortableBoxesTmpl.html",controller:"TaskSortableBoxesCtrl",controllerAs:"$ctrl"}).controller("TaskSortableBoxesCtrl",t)}(),function(){function t(t){var e=this;e.zoomImg=function(){t.zoomPicture(e.src,e.alt,!0)}}t.$inject=["staticService"],angular.module("app").component("zoomImg",{bindings:{src:"@",alt:"@"},templateUrl:"./js/components/zoom-img/zoomImgTmpl.html",controller:"ZoomImgCtrl",controllerAs:"$ctrl"}).controller("ZoomImgCtrl",t)}();