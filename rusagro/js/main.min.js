"use strict";!function(){function t(t,e){t.state("contents",{url:"/contents",views:{header:{templateUrl:"js/components/header/headerContentsTmpl.html",controller:"HeaderContentsCtrl",controllerAs:"$ctrl"},content:{templateUrl:"pages/contents/index.html"}}}).state("page",{url:"/chapter/:module/page/:path",views:{header:{templateUrl:"js/components/header/headerTmpl.html",controller:"HeaderCtrl",controllerAs:"$ctrl"},content:{templateUrl:function(t){return"pages/"+(Number(t.module)>9?"chapter"+t.module:"chapter0"+t.module)+"/"+(Number(t.path)>9?"page"+t.path:"page0"+t.path)+"/index.html"},controller:"PageCtrl",controllerAs:"$ctrl"},footer:{templateUrl:"js/components/footer/footerTmpl.html",controller:"FooterCtrl",controllerAs:"$ctrl"}}}),e.otherwise("/contents")}function e(t,e,r,a){t.$on("$stateChangeStart",function(t,e,r,n,s,o){a.closeModal(),a.stopAudio(!0),a.setAudioTime(0)}),t.$on("$stateChangeSuccess",function(t,r,n,s,o,i){e(function(){a.stopAudio(!1)},100)})}t.$inject=["$stateProvider","$urlRouterProvider"],e.$inject=["$rootScope","$timeout","$state","staticService"],angular.module("app",["ui.router","ngSanitize","ngAnimate"]).constant("courseDataObj",courseStructure).constant("testDataObj",testStructure).config(t).run(e)}(),function(){function t(t,e,r,a){var n=[{type:"navModal",state:!1},{type:"glossaryModal",state:!1},{type:"statisticsModal",state:!1},{type:"exerciseModal",state:!1,title:"",answer:"",comment:"",img:""},{type:"addInfoModal",state:!1,content:""},{type:"zoomImg",state:!1,src:"",alt:""}],s=0,o=!1;this.getCourseName=function(){return{course:r.course,description:r.description}},this.getChapterObj=function(t){return r.chapters[t]},this.showModal=function(t,e,a,s,o){var i=n.filter(function(e,r,a){return e.type===t}),l=n.indexOf(i[0]);n[l].state=!n[l].state,void 0!==e&&(n[l].title=a?"Правильный ответ":"Неправильный ответ",n[l].answer="",n[l].comment=r.chapters[s].pages[o].messages[e],e===r.chapters[s].pages[o].data.attempts?n[l].img="last-attempt":n[l].img=a?"true":"false")},this.getExerciseData=function(){return{title:n[3].title,comment:n[3].comment,img:n[3].img}},this.getModalState=function(t){return n[t].state},this.closeModal=function(){n.forEach(function(t,e,r){t.state=!1})},this.getPageAmount=function(t){return r.chapters[t].pages.length},this.addInfo=function(t,e,r){n[4].content=t,n[4].state=e,n[4].heading=r},this.getAddInfo=function(){return n[4]},this.zoomPicture=function(t,e,r){n[5].src=t,n[5].alt=e,n[5].state=r},this.getZoomPicture=function(){return n[5]},this.setAudioTime=function(t){s=t},this.getAudioTime=function(){return s},this.stopAudio=function(t){o=t},this.getStopAudio=function(){return o};var i=!1;this.startAudio=function(t){if(0===arguments.length)return i;i=t},this.getExerciseObject=function(t){return r.chapters[t.module-1].pages[t.path-1].data},this.getData=function(t,e){return r.chapters[t.module-1].pages[t.path-1].data[e]},this.getTestData=function(t){return a.chapters[t.module-1].pages.filter(function(e){return e.id===Number(t.path)})[0].data},this.getMessage=function(t,e){return r.chapters[t.module-1].pages[t.path-1].messages[e]}}t.$inject=["$document","$timeout","courseDataObj","testDataObj"],angular.module("app").service("staticService",t)}(),function(){function t(t,e){var r=t.chapters.map(function(t){return{id:t.id,visited:1,completed:!1,pages:t.pages.map(function(t,e){return{id:t.id,type:t.type,title:t.title,visited:0===e,completed:""}})}});this.getPageProgress=function(t){return{visited:r[t].visited,completed:r[t].completed}},this.getPageVisit=function(t,e){return r[t].pages[e].visited},this.setPageVisit=function(t,e){r[t].pages[e].visited=!0,r[t].visited=r[t].visited>e?r[t].visited:e+1},this.getExerciseArray=function(t){return r[t].pages.filter(function(t){return"complex_page"===t.type||"exercise"===t.type||"test"===t.type})},this.setUserProgress=function(t,e,a){r[e].pages[a].completed=t,0===_.filter(r[e].pages,function(t){if(("complex_page"===t.type||"exercise"===t.type||"test"===t.type)&&!0!==t.completed)return!0}).length&&(r[e].completed=!0)}}t.$inject=["courseDataObj","$document"],angular.module("app").service("userService",t)}(),function(){function t(t,e,r,a,n){var s=this;s.$onInit=function(){t({method:"GET",url:"img/svg-sprite.svg",cache:!0}).then(function(t){s.svgSprite=e.trustAsHtml(t.data)},function(t){console.log("error svg sprite didn't load...")})},s.showModal=function(t){return a.getModalState(t)},s.visitedPage=function(t){return n.getPageProgress(Number(t)-1).visited},s.completedPage=function(t){return n.getPageProgress(Number(t)-1).completed}}t.$inject=["$http","$sce","$stateParams","staticService","userService"],angular.module("app").controller("CourseCtrl",t)}(),function(){function t(t,e){var r=this;r.tabNum=1,r.getAudioTime=function(){return e.getAudioTime()},r.startAnimation=function(){return e.startAudio(!0),r.animationBtnState=!r.animationBtnState}}t.$inject=["$document","staticService"],angular.module("app").controller("PageCtrl",t)}(),function(){function t(t,e,r){var a=this,n=[];a.addPanel=function(t){return n.push(t),"true"!==r.firstOpen||t!==n[0]},a.selectPanel=function(t,e){for(var r in n)t===n[r]&&e?n[r].turnOn():n[r].turnOff()}}function e(t,e,r){var a=this;t.isCollapsed=!0,a.$onInit=function(){t.isCollapsed=a.parent.addPanel(a)},a.turnOn=function(){t.isCollapsed=!1},a.turnOff=function(){t.isCollapsed=!0},t.toggle=function(){a.parent.selectPanel(a,t.isCollapsed)}}function r(t,e,r,a){function n(){console.log($(o).find("img").height());var t=s();o.style.height="auto";var e=s();return o.style.height=t,s(),e}function s(){return o.offsetHeight}var o=r[0],i=0;e.$watch(a.collapse,function(t){var e=t?0:1;if(1===e){if(0!==i)return o.style.height=n()+"px";i=1,function(t){setTimeout(function(){return console.log($(t).height()),o.style.height=n()+"px"},50)}(o)}return o.style.height=e+"px"})}t.$inject=["$scope","$element","$attrs"],e.$inject=["$scope","$element","$attrs"],r.$inject=["$document","$scope","$element","$attrs"],angular.module("app").component("accordion",{transclude:!0,template:'<div class="accordion" ng-transclude></div>',controller:"AccordionCtrl",controllerAs:"$ctrl"}).controller("AccordionCtrl",t).component("accordionPanel",{require:{parent:"^accordion"},bindings:{heading:"@"},transclude:!0,templateUrl:"js/components/accordion/accordionPanelTmpl.html",controller:"AccordionPanelCtrl",controllerAs:"$ctrl"}).controller("AccordionPanelCtrl",e).controller("AccordionContentCtrl",r)}(),function(){function t(t,e,r){this.getAddInfo=function(){r.addInfo(e.find("ng-transclude").prop("outerHTML"),!0,t.heading)}}t.$inject=["$attrs","$element","staticService"],angular.module("app").component("addInfo",{bindings:{heading:"@",position:"@"},transclude:!0,templateUrl:"./js/components/add-info/addInfoTmpl.html",controller:"AddInfoCtrl",controllerAs:"$ctrl"}).controller("AddInfoCtrl",t)}(),function(){angular.module("app").component("buttons",{template:'<div class="btn-box"><button class="btn btn_restart" ng-click="$ctrl.removeRestart()">Начать заново</button><button class="btn btn_answer" ng-click="$ctrl.checkAnswer()">Принять ответ</button></div>'})}(),function(){function t(t,e,r,a){angular.element(document).ready(function(){$("carousel-item:first").before($("carousel-item:last")),t.toPrevItem=function(t){var e=$(t.currentTarget);e.css("pointer-events","none");var r=$("carousel-item").outerWidth(),a=parseInt($(".carousel__list").css("left"))+r;$(".carousel__list:not(:animated)").animate({left:a},700,function(){$("carousel-item:first").before($("carousel-item:last")),$(".carousel__list").css({left:"-"+r+"px"}),e.css("pointer-events","auto")})},t.toNextItem=function(t){var e=$(t.currentTarget);e.css("pointer-events","none");var r=$("carousel-item").outerWidth(),a=parseInt($(".carousel__list").css("left"))-r;$(".carousel__list:not(:animated)").animate({left:a},700,function(){$("carousel-item:last").after($("carousel-item:first")),$(".carousel__list").css({left:"-"+r+"px"}),e.css("pointer-events","auto")})},$(window).resize(function(){$(".carousel__list").css({left:"-"+$("carousel-item").outerWidth()+"px"})})})}t.$inject=["$scope","$stateParams","staticService","userService"],angular.module("app").component("carousel",{transclude:!0,template:'<div class="carousel">\n\t\t              <button class="carousel__toggler carousel__toggler_left" ng-click="toPrevItem($event)">\n\t\t              \t<svg viewBox="0 0 50 60" width="50" height="60">\n\t\t\t\t\t\t\t\t\t\t\t<use xmlns:xlink="http://www.w3.org/1999/xlink" \n\t\t\t\t\t\t\t\t\t\t\t\t\t xlink:href="#carousel_arrow-left">\n\t\t\t\t\t\t\t\t\t\t\t</use>\n\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t              </button>\n\t\t                <ul class="carousel__list" ng-transclude>\n\t\t                </ul>\n\t\t              <button class="carousel__toggler carousel__toggler_right" ng-click="toNextItem($event)">\n\t\t              \t<svg viewBox="0 0 50 60" width="50" height="60">\n\t\t\t\t\t\t\t\t\t\t\t<use xmlns:xlink="http://www.w3.org/1999/xlink" \n\t\t\t\t\t\t\t\t\t\t\t\t\t xlink:href="#carousel_arrow-right">\n\t\t\t\t\t\t\t\t\t\t\t</use>\n\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t              </button>\n\t\t             </div>',controller:"carouselCtrl"}).component("carouselItem",{bindings:{src:"@",alt:"@",title:"@"},transclude:!0,template:'<li class="carousel__item">\n\t\t                <img class="carousel__img" ng-src="{{$ctrl.src}}" alt="{{$ctrl.alt}}" width="100%">\n\t\t                <div class="carousel__caption">\n\t\t                  <h3 class="carousel__caption-title">{{$ctrl.title}}</h3>\n\t\t                  <p class="carousel__caption-text" ng-transclude></p>\n\t\t                </div>\n\t\t              </li>'}).controller("carouselCtrl",t)}(),function(){function t(t,e,r){var a=this;a.play="#play",a.mute="#unmute",a.volume=1,a.$onInit=function(){a.audio=t[0].createElement("audio"),a.audio.src="pages/chapter"+a.module+"/page"+a.page+"/audio/page-"+a.module+"-"+a.page+".mp3",a.audio.oncanplaythrough=function(){a.changePlayPause=function(){a.audio.paused?(a.audio.play(),a.play="#pause"):(a.audio.pause(),a.play="#play")},a.updateSeekSlider=function(){var t=a.audio.currentTime*(100/a.audio.duration),e=Math.floor(a.audio.currentTime/60),r=Math.floor(a.audio.currentTime-60*e),n=Math.floor(a.audio.duration/60),s=Math.floor(a.audio.duration-60*n);a.seekPos=Math.floor(t),e<10&&(e="0"+e),r<10&&(r="0"+r),n<10&&(n="0"+n),s<10&&(s="0"+s),a.curTime=e+":"+r,a.durTime=n+":"+s,a.audio.currentTime===a.audio.duration&&(a.play="#play")},a.changeSeekPos=function(){a.audio.currentTime=a.audio.duration*(a.seekPos/100)},e(function(){if(a.audio){if(a.updateSeekSlider(),r.setAudioTime(a.audio.currentTime),r.getStopAudio())return a.audio.pause(),void(a.audio=null);r.startAudio()&&(a.audio.play(),a.play="#pause",r.startAudio(!1))}},100),a.changeMuteState=function(){a.mute="#unmute",a.audio.muted?(a.audio.muted=!1,a.mute="#unmute"):(a.audio.muted=!0,a.mute="#mute")},a.changeVolume=function(){a.audio.volume=a.volume},a.restart=function(){a.audio.currentTime=0,a.audio.play(),a.play="#pause"}}}}t.$inject=["$document","$interval","staticService"],angular.module("app").component("customAudio",{bindings:{module:"@",page:"@"},templateUrl:"js/components/custom-audio/customAudioTmpl.html",controller:"CustomAudioCtrl",controllerAs:"$ctrl"}).controller("CustomAudioCtrl",t)}(),function(){function t(t,e,r,a){var n=this;n.moduleNum=e.module>9?e.module:"0"+e.module,n.pageNum=e.path>9?e.path:"0"+e.path,n.curPageNum=e.path,n.pageAmount=""+r.getPageAmount(Number(e.module)-1),n.toBack=function(){"1"!==n.curPageNum&&t.go("page",{module:e.module,path:Number(n.curPageNum)-1})},n.toForward=function(){n.curPageNum!==n.pageAmount&&(a.setPageVisit(Number(e.module)-1,Number(n.curPageNum)),t.go("page",{module:e.module,path:Number(n.curPageNum)+1}))}}t.$inject=["$state","$stateParams","staticService","userService"],angular.module("app").controller("FooterCtrl",t)}(),function(){function t(t){this.courseTitle=t.getCourseName()}t.$inject=["staticService"],angular.module("app").controller("HeaderContentsCtrl",t)}(),function(){function t(t,e,r){var a=this;a.chapterPages=e.getChapterObj(Number(t.module)-1),a.title={module:a.chapterPages.title,exercise:a.chapterPages.pages[Number(t.path)-1].title},a.showModal=function(t){return e.getModalState(t)},a.getExerciseData=function(){return e.getExerciseData()},a.closeModal=function(){e.closeModal()},a.toggleNavigation=function(){$(this).hasClass("btn_nav-active")?e.closeModal():e.showModal("navModal")},a.toggleGlossary=function(){$(this).hasClass("btn_nav-active")?e.closeModal():e.showModal("glossaryModal")},a.toggleStatistics=function(){$(this).hasClass("btn_nav-active")?e.closeModal():e.showModal("statisticsModal")},a.getUserObj=function(){return r.getExerciseArray(Number(t.module)-1)},a.getCompletedTaskNumber=function(){return r.getExerciseArray(Number(t.module)-1).filter(function(t){return!!t.completed})},a.getPageVisit=function(e){return r.getPageVisit(Number(t.module)-1,Number(e))},a.addInfo=function(){return e.getAddInfo()},a.value=100,a.picture=function(){return e.getZoomPicture()},a.definition=[{term:"5S",description:"система организации и поддержания в порядке вашего рабочего места."},{term:"RACI-матрица ответственности",description:"общая схема распределения персональной ответственности."},{term:"SOP",description:"стандартные операционные процедуры, в которых описана последовательность конкретных шагов в рамках той или иной активности."},{term:"Карта процессов",description:"это схематичный документ, отображающий процессы шаг за шагом, в структурированном виде, разбитый на несколько уровней."},{term:"Макропроцессы",description:"это бизнес-процессы, которые организуют деятельность предприятия на самом высоком уровне. Главный макропроцесс должен быть обязательно связан с продуктом, который производит предприятие."},{term:"Процесс",description:"это любые действия, которые являются средством для превращения входных данных/материалов в продукцию/услуги с целью удовлетворения нужд потребителя/внутреннего клиента."}]}t.$inject=["$stateParams","staticService","userService"],angular.module("app").controller("HeaderCtrl",t)}(),function(){function t(t,e,r,a){var n=this,s=0;n.taskData=r.getExerciseObject(t),n.taskData.userList=[],n.btnDisabledState={restart:!1,answer:!1},angular.element(e).ready(function(){n.getBtnState=function(){return n.btnDisabledState},n.checkAnswer=function(){var e;n.btnDisabledState.answer=!0,s+=1;for(var o=0;o<n.taskData.answerList.length;o++)n.taskData.answerList[o]!==$.trim(n.taskData.userList[o]).replace(".",",")&&(e=!1);if(!1===e){if(s===n.taskData.attempts){if(n.taskData.showAnswer)for(var o=0;o<n.taskData.answerList.length;o++)n.taskData.userList[o]=n.taskData.answerList[o];return s=0,n.btnDisabledState.restart=!0,a.setUserProgress(!1,Number(t.module)-1,Number(t.path)-1),r.showModal("exerciseModal",n.taskData.attempts,!1,Number(t.module)-1,Number(t.path)-1)}return a.setUserProgress(!1,Number(t.module)-1,Number(t.path)-1),r.showModal("exerciseModal",s,!1,Number(t.module)-1,Number(t.path)-1)}return n.btnDisabledState.restart=!0,a.setUserProgress(!0,Number(t.module)-1,Number(t.path)-1),r.showModal("exerciseModal",0,!0,Number(t.module)-1,Number(t.path)-1)},n.removeRestart=function(){n.btnDisabledState.answer=!1,n.taskData.userList=[]}})}t.$inject=["$stateParams","$document","staticService","userService"],angular.module("app").controller("TaskFillingFieldsCtrl",t)}(),function(){function t(t,e,r,a,n){var s,o,i=this,l=0;i.taskData=a.getExerciseObject(r),i.taskText=i.taskData.taskText,i.imageList=i.taskData.imageList,i.stateNum=0,i.btnDisabledState={restart:!1,answer:!1},s=i.taskData.bannerStart,o=i.taskData.bannerEnd,i.banner=s,angular.element(e).ready(function(){i.check=function(t){i.imageList[t].checkedBlock=!i.imageList[t].checkedBlock,i.stateNum=i.imageList.reduce(function(t,e){return e.checkedBlock&&t++,t},0)},i.getBtnState=function(){return i.btnDisabledState},i.checkAnswer=function(){console.log(i.imageList),i.btnDisabledState.answer=!0,l+=1;for(var t=0;t<i.imageList.length;t++)if(i.imageList[t].checkedBlock!==i.imageList[t].needCheckedAns)return l===i.taskData.attempts?(i.taskData.showAnswer&&(i.banner=o,i.imageList.forEach(function(t){t.checkedBlock=t.needCheckedAns})),l=0,i.btnDisabledState.restart=!0,n.setUserProgress(!1,Number(r.module)-1,Number(r.path)-1),a.showModal("exerciseModal",i.taskData.attempts,!1,Number(r.module)-1,Number(r.path)-1)):(n.setUserProgress(!1,Number(r.module)-1,Number(r.path)-1),a.showModal("exerciseModal",l,!1,Number(r.module)-1,Number(r.path)-1));i.banner=o,i.btnDisabledState.restart=!0,n.setUserProgress(!0,Number(r.module)-1,Number(r.path)-1),a.showModal("exerciseModal",0,!0,Number(r.module)-1,Number(r.path)-1)},i.removeRestart=function(){var t,e=$(".gallery-item"),r=[];if(i.banner=s,i.btnDisabledState.answer=!1,i.imageList.forEach(function(t){t.checkedBlock=!1}),i.taskData.shuffle){for(var a=0;a<e.length;a++)r.push(a);r=_.shuffle(r),t=r[0];for(var a=1;a<e.length;a++)$(e[t]).after(e[r[a]]),t=r[a]}},i.removeRestart()})}t.$inject=["$element","$document","$stateParams","staticService","userService"],angular.module("app").component("taskImageCheck",{templateUrl:"js/components/task-image-check/taskImageCheckTmpl.html",controller:"TaskImageCheckCtrl",controllerAs:"$ctrl"}).controller("TaskImageCheckCtrl",t)}(),function(){function t(t,e,r,a){var n,s,o=this,i=0;o.taskData=r.getExerciseObject(e),o.answerList=o.taskData.answerList,n=o.taskData.bannerStart,s=o.taskData.bannerEnd,o.banner=n,o.stateNum=0,o.btnDisabledState={restart:!1,answer:!1},angular.element(t).ready(function(){o.check=function(t,e){""===o.answerList[e].checkedBlock&&o.stateNum++,o.answerList[e].checkedBlock=t},o.getBtnState=function(){return o.btnDisabledState},o.checkAnswer=function(){o.stateNum=0,o.btnDisabledState.answer=!0,i+=1;for(var t=0;t<o.answerList.length;t++)if(o.answerList[t].checkedBlock!==o.answerList[t].needCheckedAns)return i===o.taskData.attempts?(o.taskData.showAnswer&&o.answerList.forEach(function(t){t.checkedBlock=t.needCheckedAns}),i=0,o.btnDisabledState.restart=!0,a.setUserProgress(!1,Number(e.module)-1,Number(e.path)-1),r.showModal("exerciseModal",o.taskData.attempts,!1,Number(e.module)-1,Number(e.path)-1)):(a.setUserProgress(!1,Number(e.module)-1,Number(e.path)-1),r.showModal("exerciseModal",i,!1,Number(e.module)-1,Number(e.path)-1));return o.banner=s,o.btnDisabledState.restart=!0,a.setUserProgress(!0,Number(e.module)-1,Number(e.path)-1),r.showModal("exerciseModal",0,!0,Number(e.module)-1,Number(e.path)-1)},o.removeRestart=function(){var t=$(".box");if(o.btnDisabledState.answer=!1,o.answerList.forEach(function(t){t.checkedBlock=""}),o.taskData.shuffle)for(var e=0;e<t.length;e++){for(var r,a=$(t[e]).find(".box__item"),n=[],s=0;s<a.length;s++)n[s]=s;n=_.shuffle(n),r=n[0];for(var s=1;s<a.length;s++)$(a[r]).after(a[n[s]]),r=n[s]}},o.removeRestart()})}t.$inject=["$document","$stateParams","staticService","userService"],angular.module("app").controller("TaskImageSingleChoiceCtrl",t)}(),function(){function t(t,e,r){var a=this;a.state=!1,a.attemptNum=0,a.showComment=!1,a.taskText=e.getData(t,"taskText"),a.answerList=e.getData(t,"answerList"),angular.element(document).ready(function(){function n(t,e,r,a,n,s,o){var l=-1===t&&0!==n||1===t&&0!==a?500:300,u=e/l,c=r/l,m=a/l,d=n/l,g=Date.now(),p=$(".ranging-blocks").css("pointer-events","none");s.css("z-index","1");var f=setInterval(function(){var e=Date.now()-g;if(e>=l)return clearInterval(f),s[0].style.top="0px",o[0].style.top="0px",t>0?s.after(o):s.before(o),i=$(".ranging-blocks__item"),s.css("z-index","0"),p=$(".ranging-blocks").css("pointer-events","auto"),s.css("margin-top",n+"px"),void o.css("margin-top",a+"px");t>0?(s[0].style.top=-e*(c+m)+"px",o[0].style.top=e*(u+m)+"px"):(s[0].style.top=e*(c+d)+"px",o[0].style.top=-e*(u+d)+"px")},20)}function s(t){return{size:t.outerWidth()-t.innerWidth()+(t.innerWidth()-t.width())+(t.outerWidth(!0)-t.outerWidth())+t.height(),style:Number($(t).css("margin-top").split("px")[0])}}var o,i=$(".ranging-blocks__item"),l=$(".arrow_up"),u=$(".arrow_down");a.toArrowUp=function(t){var e=t.currentTarget,r=$.inArray(e,l);0!==r&&-1!==r&&n(1,s(i.eq(r)).size,s(i.eq(r-1)).size,s(i.eq(r)).style,s(i.eq(r-1)).style,i.eq(r),i.eq(r-1))},a.toArrowDown=function(t){var e=$.inArray(t.currentTarget,u);e!==u.length-1&&-1!==e&&n(-1,s(i.eq(e)).size,s(i.eq(e+1)).size,s(i.eq(e)).style,s(i.eq(e+1)).style,i.eq(e),i.eq(e+1))},a.checkAnswer=function(){for(3===a.attemptNum&&(a.attemptNum=0),a.attemptNum=a.attemptNum+1,o=0;o<i.length;o++)if($(i[o]).attr("data-section")!==a.answerList[o].section)return 3===a.attemptNum&&a.setRightOrder(),r.setUserProgress(!1,Number(t.module)-1,Number(t.path)-1),e.showModal("exerciseModal",a.attemptNum,!1,Number(t.module)-1,Number(t.path)-1);r.setUserProgress(!0,Number(t.module)-1,Number(t.path)-1),e.showModal("exerciseModal",0,!0,Number(t.module)-1,Number(t.path)-1)},a.removeRestart=function(){for(var t,e=[],r=0;r<i.length;r++)e.push(r);for(e=_.shuffle(e),t=e[0],r=1;r<i.length;r++)$(i[t]).after(i[e[r]]),t=e[r];for(i=$(".ranging-blocks__item"),r=0;r<i.length;r++)$(i[r]).css("margin-top",a.answerList[r].marginTop)},a.removeRestart(),a.setRightOrder=function(){}})}t.$inject=["$stateParams","staticService","userService"],angular.module("app").controller("TaskRangingCtrl",t)}(),function(){function t(t,e,r,a,n){var s=this,o=0,i=$(e).find(".sort__content");s.taskData=a.getExerciseObject(t),s.btnDisabledState={restart:!1,answer:!1},$(e).find(".sort").sortable({containment:".sort-wrapper"}),$(".sort").disableSelection(),angular.element(r).ready(function(){s.getBtnState=function(){return s.btnDisabledState},s.checkAnswer=function(){var r=$(e).find(".sort__content");s.btnDisabledState.answer=!0,o+=1;for(var l=0;l<i.length;l++)if($.trim(r[l].innerHTML)!==$.trim(i[l].innerHTML)){if(o===s.taskData.attempts){if(s.taskData.showAnswer)for(var l=1;l<i.length;l++)$(i[l-1]).after(i[l]);return o=0,s.btnDisabledState.restart=!0,n.setUserProgress(!1,Number(t.module)-1,Number(t.path)-1),a.showModal("exerciseModal",s.taskData.attempts,!1,Number(t.module)-1,Number(t.path)-1)}return n.setUserProgress(!1,Number(t.module)-1,Number(t.path)-1),a.showModal("exerciseModal",o,!1,Number(t.module)-1,Number(t.path)-1)}return s.btnDisabledState.restart=!0,n.setUserProgress(!0,Number(t.module)-1,Number(t.path)-1),a.showModal("exerciseModal",0,!0,Number(t.module)-1,Number(t.path)-1)},s.removeRestart=function(){var t,r=$(e).find(".sort__content"),a=[];if(s.btnDisabledState.answer=!1,s.taskData.shuffle){for(var n=0;n<r.length;n++)a.push(n);for(a=_.shuffle(a),t=a[0],n=1;n<r.length;n++)$(r[t]).after(r[a[n]]),t=a[n]}},s.removeRestart()})}t.$inject=["$stateParams","$element","$document","staticService","userService"],angular.module("app").controller("TaskRangingSortCtrl",t)}(),function(){function t(t,e,r){function a(t,e){if(t.classList.contains("fixed"))return void console.warn("drop on fixed");var r=t.parentNode,a=t.nextSibling===e?t:t.nextSibling;e.parentNode.insertBefore(t,e),r.insertBefore(e,a),e.style.left="0px",e.style.top="0px"}function n(){var t=0;for(c=1;c<o.length;c++)$(o[t]).after(o[c]),t=c}var s=this,o=$(".sort").find(".swapable, .fixed"),i=$(".fixed"),l=[],u=0;if(s.taskData=e.getExerciseObject(t),i.length)for(var c=0;c<o.length;c++)$(o[c]).hasClass("fixed")&&l.push(c);s.btnDisabledState={restart:!1,answer:!1},$(".swapable").draggable({zIndex:2,containment:".sort-wrapper",stop:function(t,e){e.helper.css("top","0"),e.helper.css("left","0")}}).droppable({drop:function(t,e){a($(this).get(0),$(e.draggable).get(0))}}),s.getBtnState=function(){return s.btnDisabledState},s.checkAnswer=function(){var a=$(".sort").find(".swapable, .fixed");if(s.btnDisabledState.answer=!0,u+=1,s.taskData.rangeCategory){for(var i=0;i<o.length;i++)if($(a[i]).attr("data-category")!==$(o[i]).attr("data-category"))return u===s.taskData.attempts?(s.taskData.showAnswer&&n(),u=0,s.btnDisabledState.restart=!0,r.setUserProgress(!1,Number(t.module)-1,Number(t.path)-1),e.showModal("exerciseModal",s.taskData.attempts,!1,Number(t.module)-1,Number(t.path)-1)):(r.setUserProgress(!1,Number(t.module)-1,Number(t.path)-1),e.showModal("exerciseModal",u,!1,Number(t.module)-1,Number(t.path)-1))}else for(var i=0;i<o.length;i++)if($(a[i]).index($(o))!==i)return u===s.taskData.attempts?(s.taskData.showAnswer&&n(),u=0,s.btnDisabledState.restart=!0,r.setUserProgress(!1,Number(t.module)-1,Number(t.path)-1),e.showModal("exerciseModal",s.taskData.attempts,!1,Number(t.module)-1,Number(t.path)-1)):(r.setUserProgress(!1,Number(t.module)-1,Number(t.path)-1),e.showModal("exerciseModal",u,!1,Number(t.module)-1,Number(t.path)-1));return s.btnDisabledState.restart=!0,r.setUserProgress(!0,Number(t.module)-1,Number(t.path)-1),e.showModal("exerciseModal",0,!0,Number(t.module)-1,Number(t.path)-1)},s.removeRestart=function(){var t,e,r=[];if(s.btnDisabledState.answer=!1,s.taskData.shuffle){for(var a=0;a<o.length;a++)r.push(a);for(r=_.shuffle(r),t=r[0],a=1;a<o.length;a++)$(o[t]).after(o[r[a]]),t=r[a];if(i.length){e=$(".sort").find(".swapable, .fixed");for(var a=0;a<i.length;a++)$(e[e.length-1]).after(i[a]);e=$(".sort").find(".swapable, .fixed");for(var a=0;a<i.length;a++)$(e[l[a]]).before(i[a]),e=$(".sort").find(".swapable, .fixed")}}},s.removeRestart()}t.$inject=["$stateParams","staticService","userService"],angular.module("app").controller("TaskRangingSwapableCtrl",t)}(),function(){angular.module("app").component("taskRangingText",{bindings:{shuffle:"@",lastAttempt:"@",showAnswer:"@"},templateUrl:"js/components/task-ranging/taskRangingTextTmpl.html",controller:"TaskRangingCtrl",controllerAs:"$ctrl"})}(),function(){function t(t,e,r){var a=this;a.state=!1,a.attemptNum=0,a.showComment=!1,a.taskText=e.getData(t,"taskText"),a.answerList=e.getData(t,"answerList"),angular.element(document).ready(function(){function n(t,e,r,a,n,s,o){var l=-1===t&&0!==n||1===t&&0!==a?500:300,u=e/l,c=r/l,m=a/l,d=n/l,g=Date.now(),p=$(".ranging-blocks").css("pointer-events","none");s.css("z-index","1");var f=setInterval(function(){var e=Date.now()-g;if(e>=l)return clearInterval(f),s[0].style.top="0px",o[0].style.top="0px",t>0?s.after(o):s.before(o),i=$(".ranging-blocks__item"),s.css("z-index","0"),p=$(".ranging-blocks").css("pointer-events","auto"),s.css("margin-top",n+"px"),void o.css("margin-top",a+"px");t>0?(s[0].style.top=-e*(c+m)+"px",o[0].style.top=e*(u+m)+"px"):(s[0].style.top=e*(c+d)+"px",o[0].style.top=-e*(u+d)+"px")},20)}function s(t){return{size:t.outerWidth()-t.innerWidth()+(t.innerWidth()-t.width())+(t.outerWidth(!0)-t.outerWidth())+t.height(),style:Number($(t).css("margin-top").split("px")[0])}}var o,i=$(".ranging-blocks__item"),l=$(".arrow_up"),u=$(".arrow_down");a.toArrowUp=function(t){var e=t.currentTarget,r=$.inArray(e,l);0!==r&&-1!==r&&n(1,s(i.eq(r)).size,s(i.eq(r-1)).size,s(i.eq(r)).style,s(i.eq(r-1)).style,i.eq(r),i.eq(r-1))},a.toArrowDown=function(t){var e=$.inArray(t.currentTarget,u);e!==u.length-1&&-1!==e&&n(-1,s(i.eq(e)).size,s(i.eq(e+1)).size,s(i.eq(e)).style,s(i.eq(e+1)).style,i.eq(e),i.eq(e+1))},a.checkAnswer=function(){for(3===a.attemptNum&&(a.attemptNum=0),a.attemptNum=a.attemptNum+1,o=0;o<i.length;o++)if($(i[o]).attr("data-section")!==a.answerList[o].section)return 3===a.attemptNum&&a.setRightOrder(),r.setUserProgress(!1,Number(t.module)-1,Number(t.path)-1),e.showModal("exerciseModal",a.attemptNum,!1,Number(t.module)-1,Number(t.path)-1);r.setUserProgress(!0,Number(t.module)-1,Number(t.path)-1),e.showModal("exerciseModal",0,!0,Number(t.module)-1,Number(t.path)-1)},a.removeRestart=function(){for(var t,e=[],r=0;r<i.length;r++)e.push(r);for(e=_.shuffle(e),t=e[0],r=1;r<i.length;r++)$(i[t]).after(i[e[r]]),t=e[r];for(i=$(".ranging-blocks__item"),r=0;r<i.length;r++)$(i[r]).css("margin-top",a.answerList[r].marginTop)},a.removeRestart(),a.setRightOrder=function(){var t=i.map(function(t,e){return{index:t,rightIndex:$(e).attr("data-section")}});t.sort(function(t,e){return t.rightIndex-e.rightIndex}),console.log("rightOrderedList",t);var e=t[0].index;for(o=1;o<i.length;o++)console.log(i[t[o].index]),$(i[e]).after(i[t[o].index]),e=t[o].index}})}t.$inject=["$stateParams","staticService","userService"],angular.module("app").component("taskRangingTextOl",{bindings:{shuffle:"@",lastAttempt:"@",showAnswer:"@"},templateUrl:"js/components/task-ranging/taskRangingTextOlTmpl.html",controller:"TaskRangingTextCtrl",controllerAs:"$ctrl"}).controller("TaskRangingTextCtrl",t)}(),function(){angular.module("app").component("taskRangingWithShelves",{bindings:{shuffle:"@",lastAttempt:"@",showAnswer:"@"},templateUrl:"js/components/task-ranging/taskRangingWithShelvesTmpl.html",controller:"TaskRangingCtrl",controllerAs:"$ctrl"})}(),function(){function t(t,e,r,a,n){var s=this,o=0;s.taskData=a.getExerciseObject(t),s.taskText=s.taskData.taskText,s.questionList=s.taskData.questionList,s.stateNum=0,s.btnDisabledState={restart:!1,answer:!1},s.questionList.forEach(function(t){t.state=!1,t.variant.forEach(function(t){t.answer=!1})}),angular.element(e).ready(function(){s.checkVariant=function(t,e){!1===s.questionList[e].state&&(s.stateNum=s.stateNum+1,s.questionList[e].state=!0),s.questionList[e].variant.forEach(function(t){t.answer=!1}),s.questionList[e].variant[t].answer=!0},s.getBtnState=function(){return s.btnDisabledState},s.checkAnswer=function(){s.stateNum=0,s.btnDisabledState.answer=!0,o+=1;for(var e=0;e<s.questionList.length;e++)for(var r=0;r<s.questionList[e].variant.length;r++)if(s.questionList[e].variant[r].rightAnswer!==s.questionList[e].variant[r].answer)return o===s.taskData.attempts?(s.taskData.showAnswer&&s.questionList.forEach(function(t){t.variant.forEach(function(t){t.answer=t.rightAnswer})}),o=0,s.btnDisabledState.restart=!0,n.setUserProgress(!1,Number(t.module)-1,Number(t.path)-1),a.showModal("exerciseModal",s.taskData.attempts,!1,Number(t.module)-1,Number(t.path)-1)):(n.setUserProgress(!1,Number(t.module)-1,Number(t.path)-1),a.showModal("exerciseModal",o,!1,Number(t.module)-1,Number(t.path)-1));return s.btnDisabledState.restart=!0,n.setUserProgress(!0,Number(t.module)-1,Number(t.path)-1),a.showModal("exerciseModal",0,!0,Number(t.module)-1,Number(t.path)-1)},s.removeRestart=function(){var t=$(r).find(".task__single-choice-block");if(s.btnDisabledState.answer=!1,s.questionList.forEach(function(t){t.state=!1,t.variant.forEach(function(t){t.answer=!1})}),s.taskData.shuffle)for(var e=0;e<t.length;e++){for(var a,n=$(t[e]).find(".task__single-choice-item"),o=[],i=0;i<n.length;i++)o[i]=i;o=_.shuffle(o),a=o[0];for(var i=1;i<n.length;i++)$(n[a]).after(n[o[i]]),a=o[i]}},s.removeRestart()})}t.$inject=["$stateParams","$document","$element","staticService","userService"],angular.module("app").component("taskSingleChoice",{templateUrl:"js/components/task-single-choice/taskSingleChoiceTmpl.html",controller:"SingleChoiceCtrl",controllerAs:"$ctrl"}).controller("SingleChoiceCtrl",t)}(),function(){function t(t,e,r,a){var n=this;n.attemptNum=0,n.showComment=!1,n.taskText=r.getData(e,"taskText"),n.cards=r.getData(e,"cards"),angular.element(document).ready(function(){n.state=!1;var s=$(t).find("img"),o=$(t).find(".sortable-box");console.log(t,s,o),$(t).find(".sortable-box").sortable({containment:".task-sortable",connectWith:$(t).find(".sortable-box"),start:function(e,r){r.item.attr("number",$.inArray(this,$(t).find(".sortable-box")))},update:function(e,r){$(this).find("img").length>1&&!$(this).hasClass("variant-field")&&r.item.appendTo($(t).find(".sortable-box")[r.item.attr("number")]),0===$(t).find(".variant-field").find(".task-sortable__img").length&&(n.state=!0)}}),n.checkAnswer=function(){n.state=!1;for(var s=$(t).find(".box-field").find(".sortable-box"),o=0;o<s.length;o++)if(console.log($(s[o]).find("img").attr("src"),n.cards[o].src),$.trim($(s[o]).find("img").attr("src"))!==$.trim(n.cards[o].src))return a.setUserProgress(!1,Number(e.module)-1,Number(e.path)-1),
r.showModal("exerciseModal",1,!1,Number(e.module)-1,Number(e.path)-1);a.setUserProgress(!0,Number(e.module)-1,Number(e.path)-1),r.showModal("exerciseModal",0,!0,Number(e.module)-1,Number(e.path)-1)},n.removeRestart=function(){for(var e=$(t).find("img"),r=$(t).find(".variant-field"),a=1;a<e.length;a++)$(e[a]).appendTo(r);var s,o=[];for(a=0;a<n.cards.length;a++)o[a]=a;for(o=_.shuffle(o),s=o[0],a=1;a<e.length;a++)$(e[s]).after(e[o[a]]),s=o[a]},n.removeRestart()})}t.$inject=["$element","$stateParams","staticService","userService"],angular.module("app").component("taskSortableBoxes",{templateUrl:"js/components/task-sortable-boxes/taskSortableBoxesTmpl.html",controller:"TaskSortableBoxesCtrl",controllerAs:"$ctrl"}).controller("TaskSortableBoxesCtrl",t)}(),function(){function t(t,e,r){function a(t,e){if(s.currentQuestNum<s.taskList.length-1)s.currentQuestNum++;else for(t=s.taskList.filter(function(t){return!0===t.state}).length,n=0;n<o.length;n++)if(t/s.taskList.length*100>=Number(o[n]))return console.log(t/s.taskList.length*100,o[n]);return t}var n,s=this,o=t.score.split(",");s.currentQuestNum=0,s.taskList=r.getTestData(e),console.log(s.taskList),s.taskList.forEach(function(t){return t.variant.forEach(function(t){return t.answer=!1}),t.state=!1}),s.state=0,s.getCurrentQuestNum=function(){return s.currentQuestNum},s.checkItem=function(t,e){return"single-choice"===s.taskList[e].type&&s.taskList[e].variant.forEach(function(t){return t.answer=!1}),s.taskList[e].variant[t].answer=!s.taskList[e].variant[t].answer,0!==s.taskList[e].variant.filter(function(t){return!0===t.answer}).length?s.state=1:s.state=0},s.checkAnswer=function(){var t,e;t=s.taskList[s.currentQuestNum].variant.filter(function(t){return t.answer!==t.rightAnswer}),0===t.length?(s.taskList[s.currentQuestNum].state=!0,e=a(e,!0)):(s.taskList[s.currentQuestNum].state=!1,e=a(e,!1))},s.removeRestart=function(){s.currentQuestNum=0,s.taskList=_.shuffle(s.taskList),s.taskList.forEach(function(t){return t.state=!1,t.variant.forEach(function(t){return t.answer=!1}),t.variant=_.shuffle(t.variant)})},s.removeRestart()}t.$inject=["$attrs","$stateParams","staticService"],angular.module("app").component("taskTest",{bindings:{score:"@"},templateUrl:"./js/components/task-test/taskTestTmpl.html",controller:"taskTestCtrl",controllerAs:"$ctrl"}).controller("taskTestCtrl",t)}(),function(){function t(t){var e=this;e.zoomImg=function(){t.zoomPicture(e.src,e.alt,!0)}}t.$inject=["staticService"],angular.module("app").component("zoomImg",{bindings:{src:"@",alt:"@"},templateUrl:"./js/components/zoom-img/zoomImgTmpl.html",controller:"ZoomImgCtrl",controllerAs:"$ctrl"}).controller("ZoomImgCtrl",t)}();